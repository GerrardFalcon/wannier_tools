<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Welcome to WannierTools’s documentation! &#8212; WannierTools 2.1 documentation</title>
    
    <link rel="stylesheet" href="static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '2.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="static/jquery.js"></script>
    <script type="text/javascript" src="static/underscore.js"></script>
    <script type="text/javascript" src="static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="top" title="WannierTools 2.1 documentation" href="#" />
    <link rel="next" title="Installation (Linux or Mac)" href="installation.html" />
   
  <link rel="stylesheet" href="static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="welcome-to-wanniertools-s-documentation">
<h1>Welcome to WannierTools&#8217;s documentation!<a class="headerlink" href="#welcome-to-wanniertools-s-documentation" title="Permalink to this headline">¶</a></h1>
</div>
<div class="section" id="installation-and-usage">
<h1>Installation and Usage<a class="headerlink" href="#installation-and-usage" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation (Linux or Mac)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="installation.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#compilation">Compilation</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#usage">Usage</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="features.html">Features of WannierTools</a><ul>
<li class="toctree-l2"><a class="reference internal" href="features.html#bulk-band-calculation">Bulk band calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="features.html#bulkfs-calculation">BulkFS calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="features.html#energy-gap-calculations">Energy gap calculations</a></li>
<li class="toctree-l2"><a class="reference internal" href="features.html#slab-band-calculation">Slab  band calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="features.html#nanowire-nanoribbon-band-calculation">Nanowire/nanoribbon  band calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="features.html#surface-state-calculation">Surface state calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="features.html#fermi-arc-calculation">Fermi arc calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="features.html#spin-texture-calculation">Spin texture calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="features.html#berry-curvature-calculation">Berry curvature calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="features.html#wannier-charge-center-wilson-loop-calculation">Wannier charge center/Wilson loop calculation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="input.html">Input</a><ul>
<li class="toctree-l2"><a class="reference internal" href="input.html#input-dat">input.dat</a></li>
<li class="toctree-l2"><a class="reference internal" href="input.html#wannier90-hr-dat">wannier90_hr.dat</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Bi2Se3.html">Bi2Se3 example</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="subroutines-and-modules">
<h1>Subroutines and Modules<a class="headerlink" href="#subroutines-and-modules" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<ul class="simple">
<li><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></li>
<li><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></li>
<li><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></li>
</ul>
<div class="section" id="main-program">
<h2>Main program<a class="headerlink" href="#main-program" title="Permalink to this headline">¶</a></h2>
<dl class="program">
<dt id="f/main">
<em class="property">program  </em><code class="descname">main</code><a class="headerlink" href="#f/main" title="Permalink to this definition">¶</a></dt>
<dd><p>Main program of a set of tools based on Wannier90 TB</p>
<p>constructed by Q.S.Wu on 4/9/2010</p>
<p>change      by Q.S.Wu on 4/22/2010</p>
<p>changed     by Q.S.wu on July/15/2010</p>
<p>version     HmnR.data  contains soc</p>
<p>mpi-version is  tested , please report bugs to QSWU</p>
<p>Jan 25 2015 by Q.S.Wu at ETH Zurich</p>
<p><a class="reference external" href="mailto:wuquansheng&#37;&#52;&#48;gmail&#46;com">wuquansheng<span>&#64;</span>gmail<span>&#46;</span>com</a></p>
<p>Copyright (c) 2010 QuanSheng Wu. All rights reserved.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Use :</th><td class="field-body"><code class="xref f f-mod docutils literal"><span class="pre">wmpi</span></code>, <a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Call to:</th><td class="field-body"><a class="reference internal" href="#f/_/now" title="f/_/now"><code class="xref f f-func docutils literal"><span class="pre">now()</span></code></a>, <a class="reference internal" href="#f/_/header" title="f/_/header"><code class="xref f f-func docutils literal"><span class="pre">header()</span></code></a>, <a class="reference internal" href="#f/_/readinput" title="f/_/readinput"><code class="xref f f-func docutils literal"><span class="pre">readinput()</span></code></a>, <code class="xref f f-func docutils literal"><span class="pre">readhmnr()</span></code>, <a class="reference internal" href="#f/_/ek_bulk" title="f/_/ek_bulk"><code class="xref f f-func docutils literal"><span class="pre">ek_bulk()</span></code></a>, <a class="reference internal" href="#f/_/print_time_cost" title="f/_/print_time_cost"><code class="xref f f-func docutils literal"><span class="pre">print_time_cost()</span></code></a>, <a class="reference internal" href="#f/_/fermisurface" title="f/_/fermisurface"><code class="xref f f-func docutils literal"><span class="pre">fermisurface()</span></code></a>, <a class="reference internal" href="#f/_/fermisurface3d" title="f/_/fermisurface3d"><code class="xref f f-func docutils literal"><span class="pre">fermisurface3d()</span></code></a>, <a class="reference internal" href="#f/_/dos_joint_dos" title="f/_/dos_joint_dos"><code class="xref f f-func docutils literal"><span class="pre">dos_joint_dos()</span></code></a>, <a class="reference internal" href="#f/_/dos_sub" title="f/_/dos_sub"><code class="xref f f-func docutils literal"><span class="pre">dos_sub()</span></code></a>, <a class="reference internal" href="#f/_/joint_dos" title="f/_/joint_dos"><code class="xref f f-func docutils literal"><span class="pre">joint_dos()</span></code></a>, <a class="reference internal" href="#f/_/effective_mass_calc" title="f/_/effective_mass_calc"><code class="xref f f-func docutils literal"><span class="pre">effective_mass_calc()</span></code></a>, <a class="reference internal" href="#f/_/gapshape" title="f/_/gapshape"><code class="xref f f-func docutils literal"><span class="pre">gapshape()</span></code></a>, <a class="reference internal" href="#f/_/gapshape3d" title="f/_/gapshape3d"><code class="xref f f-func docutils literal"><span class="pre">gapshape3d()</span></code></a>, <a class="reference internal" href="#f/_/ek_slab" title="f/_/ek_slab"><code class="xref f f-func docutils literal"><span class="pre">ek_slab()</span></code></a>, <a class="reference internal" href="#f/_/berry_curvarture" title="f/_/berry_curvarture"><code class="xref f f-func docutils literal"><span class="pre">berry_curvarture()</span></code></a>, <a class="reference internal" href="#f/_/ek_ribbon" title="f/_/ek_ribbon"><code class="xref f f-func docutils literal"><span class="pre">ek_ribbon()</span></code></a>, <a class="reference internal" href="#f/_/wannier_center3d_plane" title="f/_/wannier_center3d_plane"><code class="xref f f-func docutils literal"><span class="pre">wannier_center3d_plane()</span></code></a>, <a class="reference internal" href="#f/_/berryphase" title="f/_/berryphase"><code class="xref f f-func docutils literal"><span class="pre">berryphase()</span></code></a>, <a class="reference internal" href="#f/_/surfstat" title="f/_/surfstat"><code class="xref f f-func docutils literal"><span class="pre">surfstat()</span></code></a>, <a class="reference internal" href="#f/_/fermiarc" title="f/_/fermiarc"><code class="xref f f-func docutils literal"><span class="pre">fermiarc()</span></code></a>, <a class="reference internal" href="#f/_/fermiarc_jdos" title="f/_/fermiarc_jdos"><code class="xref f f-func docutils literal"><span class="pre">fermiarc_jdos()</span></code></a>, <a class="reference internal" href="#f/_/spintext" title="f/_/spintext"><code class="xref f f-func docutils literal"><span class="pre">spintext()</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="subroutines-and-functions">
<h2>Subroutines and functions<a class="headerlink" href="#subroutines-and-functions" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="aux">
<h2>aux<a class="headerlink" href="#aux" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/_/now">
<em class="property">subroutine  </em><code class="descname">now</code><span class="sig-paren">(</span><em>time_now</em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/now" title="Permalink to this definition">¶</a></dt>
<dd><p>&gt; Convert the current wall-time into a real number</p>
<p>&gt; The unit is second.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>time_now</strong><em> [</em><em>real</em><em>]</em></td>
</tr>
<tr class="field-even field"><th class="field-name">Use :</th><td class="field-body"><code class="xref f f-mod docutils literal"><span class="pre">wmpi</span></code>, <a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a> (<a class="reference internal" href="#f/para/dp" title="f/para/dp"><code class="xref f f-func docutils literal"><span class="pre">dp()</span></code></a>)</td>
</tr>
<tr class="field-odd field"><th class="field-name">Called from:</th><td class="field-body"><a class="reference internal" href="#f/main" title="f/main"><code class="xref f f-prog docutils literal"><span class="pre">main</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/print_time_cost">
<em class="property">subroutine  </em><code class="descname">print_time_cost</code><span class="sig-paren">(</span><em>time_start</em>, <em>time_end</em>, <em>subname</em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/print_time_cost" title="Permalink to this definition">¶</a></dt>
<dd><p>&gt;  The unit is second.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>time_start</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>time_end</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>subname</strong><em> [</em><em>character</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Use :</th><td class="field-body"><p class="first"><code class="xref f f-mod docutils literal"><span class="pre">wmpi</span></code>, <a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a> (<a class="reference internal" href="#f/para/cpuid" title="f/para/cpuid"><code class="xref f f-func docutils literal"><span class="pre">cpuid()</span></code></a>, <a class="reference internal" href="#f/para/dp" title="f/para/dp"><code class="xref f f-func docutils literal"><span class="pre">dp()</span></code></a>, <code class="xref f f-func docutils literal"><span class="pre">stdout()</span></code>)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/main" title="f/main"><code class="xref f f-prog docutils literal"><span class="pre">main</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/header">
<em class="property">subroutine  </em><code class="descname">header</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/header" title="Permalink to this definition">¶</a></dt>
<dd><p>&gt; print header</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Use :</th><td class="field-body"><code class="xref f f-mod docutils literal"><span class="pre">wmpi</span></code>, <a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a> (<a class="reference internal" href="#f/para/cpuid" title="f/para/cpuid"><code class="xref f f-func docutils literal"><span class="pre">cpuid()</span></code></a>, <code class="xref f f-func docutils literal"><span class="pre">stdout()</span></code>)</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><a class="reference internal" href="#f/main" title="f/main"><code class="xref f f-prog docutils literal"><span class="pre">main</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="berry">
<h2>berry<a class="headerlink" href="#berry" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/_/berryphase">
<em class="property">subroutine  </em><code class="descname">berryphase</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/berryphase" title="Permalink to this definition">¶</a></dt>
<dd><p>&gt; Subroutine for calculating Berry phase for a giving path</p>
<blockquote>
<div><p>Comments:</p>
<blockquote>
<div>At present, you have to define the k path that you want
in kpoints</div></blockquote>
<p>Author : QuanSheng Wu (<a class="reference external" href="mailto:wuquansheng&#37;&#52;&#48;gmail&#46;com">wuquansheng<span>&#64;</span>gmail<span>&#46;</span>com</a>)</p>
<p>31 Mar 2016</p>
<p>Copyright (c) 2010 QuanSheng Wu. All rights reserved.</p>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Use :</th><td class="field-body"><code class="xref f f-mod docutils literal"><span class="pre">wmpi</span></code>, <a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><a class="reference internal" href="#f/main" title="f/main"><code class="xref f f-prog docutils literal"><span class="pre">main</span></code></a></td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><a class="reference internal" href="#f/_/ham_bulk" title="f/_/ham_bulk"><code class="xref f f-func docutils literal"><span class="pre">ham_bulk()</span></code></a>, <a class="reference internal" href="#f/_/eigensystem_c" title="f/_/eigensystem_c"><code class="xref f f-func docutils literal"><span class="pre">eigensystem_c()</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="berrycurvature">
<h2>berrycurvature<a class="headerlink" href="#berrycurvature" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/_/berry_curvarture">
<em class="property">subroutine  </em><code class="descname">berry_curvarture</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/berry_curvarture" title="Permalink to this definition">¶</a></dt>
<dd><p>&gt; Calculate Berry curvature</p>
<p>&gt; ref : Physical Review B 74, 195118(2006)</p>
<p>&gt; eqn (34)</p>
<p>&gt; Sep. 22 2015 by Quansheng Wu &#64; ETHZ</p>
<blockquote>
<div>Copyright (c) 2010 QuanSheng Wu. All rights reserved.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Use :</th><td class="field-body"><code class="xref f f-mod docutils literal"><span class="pre">wmpi</span></code>, <a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><a class="reference internal" href="#f/main" title="f/main"><code class="xref f f-prog docutils literal"><span class="pre">main</span></code></a></td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><a class="reference internal" href="#f/_/ham_bulk_old" title="f/_/ham_bulk_old"><code class="xref f f-func docutils literal"><span class="pre">ham_bulk_old()</span></code></a>, <a class="reference internal" href="#f/_/eigensystem_c" title="f/_/eigensystem_c"><code class="xref f f-func docutils literal"><span class="pre">eigensystem_c()</span></code></a>, <a class="reference internal" href="#f/_/mat_mul" title="f/_/mat_mul"><code class="xref f f-func docutils literal"><span class="pre">mat_mul()</span></code></a>, <a class="reference internal" href="#f/_/im_trace" title="f/_/im_trace"><code class="xref f f-func docutils literal"><span class="pre">im_trace()</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/fourier_r_to_k">
<em class="property">subroutine  </em><code class="descname">fourier_r_to_k</code><span class="sig-paren">(</span><em>k</em>, <em>ham</em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/fourier_r_to_k" title="Permalink to this definition">¶</a></dt>
<dd><p>&gt; Fourier transform the Hamiltonian from R space to k space</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>k</strong> (3)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>ham</strong> (<a class="reference internal" href="#f/para/num_wann" title="f/para/num_wann">num_wann</a>,<a class="reference internal" href="#f/para/num_wann" title="f/para/num_wann">num_wann</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Use :</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a> (<a class="reference internal" href="#f/para/irvec" title="f/para/irvec"><code class="xref f f-func docutils literal"><span class="pre">irvec()</span></code></a>, <a class="reference internal" href="#f/para/nrpts" title="f/para/nrpts"><code class="xref f f-func docutils literal"><span class="pre">nrpts()</span></code></a>, <a class="reference internal" href="#f/para/hmnr" title="f/para/hmnr"><code class="xref f f-func docutils literal"><span class="pre">hmnr()</span></code></a>, <a class="reference internal" href="#f/para/num_wann" title="f/para/num_wann"><code class="xref f f-func docutils literal"><span class="pre">num_wann()</span></code></a>, <a class="reference internal" href="#f/para/ndegen" title="f/para/ndegen"><code class="xref f f-func docutils literal"><span class="pre">ndegen()</span></code></a>, <a class="reference internal" href="#f/para/pi" title="f/para/pi"><code class="xref f f-func docutils literal"><span class="pre">pi()</span></code></a>, <a class="reference internal" href="#f/para/dp" title="f/para/dp"><code class="xref f f-func docutils literal"><span class="pre">dp()</span></code></a>, <a class="reference internal" href="#f/para/zi" title="f/para/zi"><code class="xref f f-func docutils literal"><span class="pre">zi()</span></code></a>)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/im_trace">
<em class="property">subroutine  </em><code class="descname">im_trace</code><span class="sig-paren">(</span><em>ndim</em>, <em>a</em>, <em>tr</em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/im_trace" title="Permalink to this definition">¶</a></dt>
<dd><p>&gt; Calculate trace only with the imaginary part of a matrix A with dimension ndim</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ndim</strong><em> [</em><em>integer</em><em>]</em></li>
<li><strong>a</strong> (<a class="reference internal" href="#f/para/ndim" title="f/para/ndim">ndim</a>,<a class="reference internal" href="#f/para/ndim" title="f/para/ndim">ndim</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>tr</strong><em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Use :</th><td class="field-body"><p class="first"><a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a> (<a class="reference internal" href="#f/para/dp" title="f/para/dp"><code class="xref f f-func docutils literal"><span class="pre">dp()</span></code></a>)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/_/berry_curvarture" title="f/_/berry_curvarture"><code class="xref f f-func docutils literal"><span class="pre">berry_curvarture()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/trace">
<em class="property">subroutine  </em><code class="descname">trace</code><span class="sig-paren">(</span><em>ndim</em>, <em>a</em>, <em>tr</em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/trace" title="Permalink to this definition">¶</a></dt>
<dd><p>&gt; Calculate trace of a matrix A with dimension ndim</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ndim</strong><em> [</em><em>integer</em><em>]</em></li>
<li><strong>a</strong> (<a class="reference internal" href="#f/para/ndim" title="f/para/ndim">ndim</a>,<a class="reference internal" href="#f/para/ndim" title="f/para/ndim">ndim</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>tr</strong><em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Use :</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a> (<a class="reference internal" href="#f/para/dp" title="f/para/dp"><code class="xref f f-func docutils literal"><span class="pre">dp()</span></code></a>)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="dos">
<h2>dos<a class="headerlink" href="#dos" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/_/dos_sub">
<em class="property">subroutine  </em><code class="descname">dos_sub</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/dos_sub" title="Permalink to this definition">¶</a></dt>
<dd><p>&gt; calculate density of state for 3D bulk system</p>
<p>&gt; DOS(omega)= sum_k delta(omega- E(k))</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Use :</th><td class="field-body"><code class="xref f f-mod docutils literal"><span class="pre">wmpi</span></code>, <a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><a class="reference internal" href="#f/main" title="f/main"><code class="xref f f-prog docutils literal"><span class="pre">main</span></code></a></td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><a class="reference internal" href="#f/_/ham_bulk" title="f/_/ham_bulk"><code class="xref f f-func docutils literal"><span class="pre">ham_bulk()</span></code></a>, <a class="reference internal" href="#f/_/eigensystem_c" title="f/_/eigensystem_c"><code class="xref f f-func docutils literal"><span class="pre">eigensystem_c()</span></code></a>, <a class="reference internal" href="#f/_/delta" title="f/_/delta"><code class="xref f f-func docutils literal"><span class="pre">delta()</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/joint_dos">
<em class="property">subroutine  </em><code class="descname">joint_dos</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/joint_dos" title="Permalink to this definition">¶</a></dt>
<dd><p>calculate joint density of state for 3D bulk system</p>
<p>JDOS(omega)= sum_k (f_c(k)-f_v(k) delta(omega- Ec(k)+ Ev(k))</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Use :</th><td class="field-body"><code class="xref f f-mod docutils literal"><span class="pre">wmpi</span></code>, <a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><a class="reference internal" href="#f/main" title="f/main"><code class="xref f f-prog docutils literal"><span class="pre">main</span></code></a></td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><a class="reference internal" href="#f/_/ham_bulk" title="f/_/ham_bulk"><code class="xref f f-func docutils literal"><span class="pre">ham_bulk()</span></code></a>, <a class="reference internal" href="#f/_/eigensystem_c" title="f/_/eigensystem_c"><code class="xref f f-func docutils literal"><span class="pre">eigensystem_c()</span></code></a>, <a class="reference internal" href="#f/_/delta" title="f/_/delta"><code class="xref f f-func docutils literal"><span class="pre">delta()</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/dos_joint_dos">
<em class="property">subroutine  </em><code class="descname">dos_joint_dos</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/dos_joint_dos" title="Permalink to this definition">¶</a></dt>
<dd><p>calculate density of state and joint density of state for 3D bulk system</p>
<p>JDOS(omega)= sum_k (f_c(k)-f_v(k) delta(omega- Ec(k)+ Ev(k))</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Use :</th><td class="field-body"><code class="xref f f-mod docutils literal"><span class="pre">wmpi</span></code>, <a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><a class="reference internal" href="#f/main" title="f/main"><code class="xref f f-prog docutils literal"><span class="pre">main</span></code></a></td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><a class="reference internal" href="#f/_/ham_bulk" title="f/_/ham_bulk"><code class="xref f f-func docutils literal"><span class="pre">ham_bulk()</span></code></a>, <a class="reference internal" href="#f/_/eigensystem_c" title="f/_/eigensystem_c"><code class="xref f f-func docutils literal"><span class="pre">eigensystem_c()</span></code></a>, <a class="reference internal" href="#f/_/delta" title="f/_/delta"><code class="xref f f-func docutils literal"><span class="pre">delta()</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="f/_/delta">
<em class="property">function  </em><code class="descname">delta</code><span class="sig-paren">(</span><em>eta</em>, <em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/delta" title="Permalink to this definition">¶</a></dt>
<dd><p>&gt;  Lorentz expansion of the Delta function</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>eta</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>x</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return:</th><td class="field-body"><p class="first"><strong>delta</strong><em> [</em><em>real</em><em>]</em></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/_/dos_sub" title="f/_/dos_sub"><code class="xref f f-func docutils literal"><span class="pre">dos_sub()</span></code></a>, <a class="reference internal" href="#f/_/joint_dos" title="f/_/joint_dos"><code class="xref f f-func docutils literal"><span class="pre">joint_dos()</span></code></a>, <a class="reference internal" href="#f/_/dos_joint_dos" title="f/_/dos_joint_dos"><code class="xref f f-func docutils literal"><span class="pre">dos_joint_dos()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="effective-mass">
<h2>effective_mass<a class="headerlink" href="#effective-mass" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/_/effective_mass_calc">
<em class="property">subroutine  </em><code class="descname">effective_mass_calc</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/effective_mass_calc" title="Permalink to this definition">¶</a></dt>
<dd><p>&gt; effective_mass_calc calculates effective mass for a
&gt; specified  band index in the framework of Wannier tight binding</p>
<p>&gt; QuanSheng Wu (<a class="reference external" href="mailto:wuquansheng&#37;&#52;&#48;gmail&#46;com">wuquansheng<span>&#64;</span>gmail<span>&#46;</span>com</a>)</p>
<p>&gt; Aug 30 2016 &#64; ETH Zurich</p>
<p>&gt; refs:</p>
<p>&gt; The effective mass calculation with VASP has been done with Alexandr Fonari</p>
<p>&gt; see <a class="reference external" href="https://afonari.com/emc.html">https://afonari.com/emc.html</a></p>
<p>&gt; Abramowitz, M.; Stegun, I. Handbook of Mathematical Functions: with Formulas, Graphs, and
&gt; Mathematical Tables; Dover, 1972.</p>
<p>&gt; here we implement the TB version</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Use :</th><td class="field-body"><code class="xref f f-mod docutils literal"><span class="pre">wmpi</span></code>, <a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><a class="reference internal" href="#f/main" title="f/main"><code class="xref f f-prog docutils literal"><span class="pre">main</span></code></a></td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><a class="reference internal" href="#f/_/cart_direct_rec" title="f/_/cart_direct_rec"><code class="xref f f-func docutils literal"><span class="pre">cart_direct_rec()</span></code></a>, <a class="reference internal" href="#f/_/ham_bulk_old" title="f/_/ham_bulk_old"><code class="xref f f-func docutils literal"><span class="pre">ham_bulk_old()</span></code></a>, <a class="reference internal" href="#f/_/eigensystem_c" title="f/_/eigensystem_c"><code class="xref f f-func docutils literal"><span class="pre">eigensystem_c()</span></code></a>, <a class="reference internal" href="#f/_/inv_r" title="f/_/inv_r"><code class="xref f f-func docutils literal"><span class="pre">inv_r()</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="eigen">
<h2>eigen<a class="headerlink" href="#eigen" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/_/eigensystem_c">
<em class="property">subroutine  </em><code class="descname">eigensystem_c</code><span class="sig-paren">(</span><em>jobz</em>, <em>uplo</em>, <em>n</em>, <em>a</em>, <em>w</em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/eigensystem_c" title="Permalink to this definition">¶</a></dt>
<dd><p>A pack of Lapack subroutine zheev, which is
:p complex a(n,n) [inout]: subroutine to calculate eigenvector and eigenvalue for a
complex hermite matrix</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>jobz</strong><em> [</em><em>character</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>uplo</strong><em> [</em><em>character</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>n</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em></li>
<li><strong>w</strong> (n)<em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Use :</th><td class="field-body"><p class="first"><a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a> (<a class="reference internal" href="#f/para/dp" title="f/para/dp"><code class="xref f f-func docutils literal"><span class="pre">dp()</span></code></a>, <code class="xref f f-func docutils literal"><span class="pre">stdout()</span></code>)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/_/landau_level_k" title="f/_/landau_level_k"><code class="xref f f-func docutils literal"><span class="pre">landau_level_k()</span></code></a>, <a class="reference internal" href="#f/_/ek_ribbon" title="f/_/ek_ribbon"><code class="xref f f-func docutils literal"><span class="pre">ek_ribbon()</span></code></a>, <a class="reference internal" href="#f/_/landau_level_b" title="f/_/landau_level_b"><code class="xref f f-func docutils literal"><span class="pre">landau_level_b()</span></code></a>, <a class="reference internal" href="#f/_/orbital_momenta" title="f/_/orbital_momenta"><code class="xref f f-func docutils literal"><span class="pre">orbital_momenta()</span></code></a>, <a class="reference internal" href="#f/_/psik_bulk" title="f/_/psik_bulk"><code class="xref f f-func docutils literal"><span class="pre">psik_bulk()</span></code></a>, <a class="reference internal" href="#f/_/wannier_center2d" title="f/_/wannier_center2d"><code class="xref f f-func docutils literal"><span class="pre">wannier_center2d()</span></code></a>, <a class="reference internal" href="#f/_/dos_sub" title="f/_/dos_sub"><code class="xref f f-func docutils literal"><span class="pre">dos_sub()</span></code></a>, <a class="reference internal" href="#f/_/wannier_center3d_plane_mirror_minus" title="f/_/wannier_center3d_plane_mirror_minus"><code class="xref f f-func docutils literal"><span class="pre">wannier_center3d_plane_mirror_minus()</span></code></a>, <a class="reference internal" href="#f/_/gapshape3d" title="f/_/gapshape3d"><code class="xref f f-func docutils literal"><span class="pre">gapshape3d()</span></code></a>, <a class="reference internal" href="#f/_/joint_dos" title="f/_/joint_dos"><code class="xref f f-func docutils literal"><span class="pre">joint_dos()</span></code></a>, <a class="reference internal" href="#f/_/gapshape" title="f/_/gapshape"><code class="xref f f-func docutils literal"><span class="pre">gapshape()</span></code></a>, <a class="reference internal" href="#f/_/get_fermilevel" title="f/_/get_fermilevel"><code class="xref f f-func docutils literal"><span class="pre">get_fermilevel()</span></code></a>, <a class="reference internal" href="#f/_/dos_joint_dos" title="f/_/dos_joint_dos"><code class="xref f f-func docutils literal"><span class="pre">dos_joint_dos()</span></code></a>, <a class="reference internal" href="#f/_/wannier_center2d_alt" title="f/_/wannier_center2d_alt"><code class="xref f f-func docutils literal"><span class="pre">wannier_center2d_alt()</span></code></a>, <code class="xref f f-func docutils literal"><span class="pre">ek_bulk2d()</span></code>, <a class="reference internal" href="#f/_/ek_slab_b" title="f/_/ek_slab_b"><code class="xref f f-func docutils literal"><span class="pre">ek_slab_b()</span></code></a>, <a class="reference internal" href="#f/_/ek_bulk_mirror_z" title="f/_/ek_bulk_mirror_z"><code class="xref f f-func docutils literal"><span class="pre">ek_bulk_mirror_z()</span></code></a>, <a class="reference internal" href="#f/_/wannier_center3d_plane_mirror_plus" title="f/_/wannier_center3d_plane_mirror_plus"><code class="xref f f-func docutils literal"><span class="pre">wannier_center3d_plane_mirror_plus()</span></code></a>, <a class="reference internal" href="#f/_/ek_bulk_mirror_x" title="f/_/ek_bulk_mirror_x"><code class="xref f f-func docutils literal"><span class="pre">ek_bulk_mirror_x()</span></code></a>, <a class="reference internal" href="#f/_/ek_slab" title="f/_/ek_slab"><code class="xref f f-func docutils literal"><span class="pre">ek_slab()</span></code></a>, <a class="reference internal" href="#f/_/ek_bulk_polar" title="f/_/ek_bulk_polar"><code class="xref f f-func docutils literal"><span class="pre">ek_bulk_polar()</span></code></a>, <a class="reference internal" href="#f/_/fermisurface3d" title="f/_/fermisurface3d"><code class="xref f f-func docutils literal"><span class="pre">fermisurface3d()</span></code></a>, <a class="reference internal" href="#f/_/wannier_center3d_plane" title="f/_/wannier_center3d_plane"><code class="xref f f-func docutils literal"><span class="pre">wannier_center3d_plane()</span></code></a>, <a class="reference internal" href="#f/_/psik" title="f/_/psik"><code class="xref f f-func docutils literal"><span class="pre">psik()</span></code></a>, <a class="reference internal" href="#f/_/berry_curvarture" title="f/_/berry_curvarture"><code class="xref f f-func docutils literal"><span class="pre">berry_curvarture()</span></code></a>, <a class="reference internal" href="#f/_/berryphase" title="f/_/berryphase"><code class="xref f f-func docutils literal"><span class="pre">berryphase()</span></code></a>, <a class="reference internal" href="#f/_/ek_bulk_fortomas" title="f/_/ek_bulk_fortomas"><code class="xref f f-func docutils literal"><span class="pre">ek_bulk_fortomas()</span></code></a>, <a class="reference internal" href="#f/_/ekb_ribbon" title="f/_/ekb_ribbon"><code class="xref f f-func docutils literal"><span class="pre">ekb_ribbon()</span></code></a>, <a class="reference internal" href="#f/_/ek_bulk" title="f/_/ek_bulk"><code class="xref f f-func docutils literal"><span class="pre">ek_bulk()</span></code></a>, <a class="reference internal" href="#f/_/effective_mass_calc" title="f/_/effective_mass_calc"><code class="xref f f-func docutils literal"><span class="pre">effective_mass_calc()</span></code></a>, <a class="reference internal" href="#f/_/wannier_center3d" title="f/_/wannier_center3d"><code class="xref f f-func docutils literal"><span class="pre">wannier_center3d()</span></code></a>, <a class="reference internal" href="#f/_/ek_bulk_spin" title="f/_/ek_bulk_spin"><code class="xref f f-func docutils literal"><span class="pre">ek_bulk_spin()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/eigensystem_r">
<em class="property">subroutine  </em><code class="descname">eigensystem_r</code><span class="sig-paren">(</span><em>jobz</em>, <em>uplo</em>, <em>n</em>, <em>a</em>, <em>w</em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/eigensystem_r" title="Permalink to this definition">¶</a></dt>
<dd><p>A pack of Lapack subroutine dsyev, which is
:p real a(n,n) [inout]: subroutine to calculate eigenvector and eigenvalue for a
real symmetric matrix</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>jobz</strong><em> [</em><em>character</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>uplo</strong><em> [</em><em>character</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>n</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em></li>
<li><strong>w</strong> (n)<em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Use :</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a> (<a class="reference internal" href="#f/para/dp" title="f/para/dp"><code class="xref f f-func docutils literal"><span class="pre">dp()</span></code></a>, <code class="xref f f-func docutils literal"><span class="pre">stdout()</span></code>)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/zgeev_pack">
<em class="property">subroutine  </em><code class="descname">zgeev_pack</code><span class="sig-paren">(</span><em>n</em>, <em>a</em>, <em>w</em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/zgeev_pack" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>a</strong> (n,n)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em> :: pack of Lapack subroutine zgeev, which is a subroutine to</td>
</tr>
</tbody>
</table>
<p>calculate eigenvector and eigenvalue of a complex hermite matrix</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>n</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em></li>
<li><strong>w</strong> (n)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Use :</th><td class="field-body"><p class="first"><a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a> (<a class="reference internal" href="#f/para/dp" title="f/para/dp"><code class="xref f f-func docutils literal"><span class="pre">dp()</span></code></a>)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/_/wannier_center2d" title="f/_/wannier_center2d"><code class="xref f f-func docutils literal"><span class="pre">wannier_center2d()</span></code></a>, <a class="reference internal" href="#f/_/wannier_center3d_plane_mirror_minus" title="f/_/wannier_center3d_plane_mirror_minus"><code class="xref f f-func docutils literal"><span class="pre">wannier_center3d_plane_mirror_minus()</span></code></a>, <a class="reference internal" href="#f/_/wannier_center2d_alt" title="f/_/wannier_center2d_alt"><code class="xref f f-func docutils literal"><span class="pre">wannier_center2d_alt()</span></code></a>, <a class="reference internal" href="#f/_/wannier_center3d_plane_mirror_plus" title="f/_/wannier_center3d_plane_mirror_plus"><code class="xref f f-func docutils literal"><span class="pre">wannier_center3d_plane_mirror_plus()</span></code></a>, <a class="reference internal" href="#f/_/wannier_center3d_plane" title="f/_/wannier_center3d_plane"><code class="xref f f-func docutils literal"><span class="pre">wannier_center3d_plane()</span></code></a>, <a class="reference internal" href="#f/_/wannier_center3d" title="f/_/wannier_center3d"><code class="xref f f-func docutils literal"><span class="pre">wannier_center3d()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="ek-bulk">
<h2>ek_bulk<a class="headerlink" href="#ek-bulk" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/_/ek_bulk">
<em class="property">subroutine  </em><code class="descname">ek_bulk</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/ek_bulk" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate bulk&#8217;s energy bands using wannier TB method</p>
<p>Copyright (c) 2010 QuanSheng Wu. All rights reserved.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Use :</th><td class="field-body"><code class="xref f f-mod docutils literal"><span class="pre">wmpi</span></code>, <a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><a class="reference internal" href="#f/main" title="f/main"><code class="xref f f-prog docutils literal"><span class="pre">main</span></code></a></td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><a class="reference internal" href="#f/_/ham_bulk_old" title="f/_/ham_bulk_old"><code class="xref f f-func docutils literal"><span class="pre">ham_bulk_old()</span></code></a>, <a class="reference internal" href="#f/_/eigensystem_c" title="f/_/eigensystem_c"><code class="xref f f-func docutils literal"><span class="pre">eigensystem_c()</span></code></a>, <a class="reference internal" href="#f/_/orbital_momenta" title="f/_/orbital_momenta"><code class="xref f f-func docutils literal"><span class="pre">orbital_momenta()</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/ek_bulk_spin">
<em class="property">subroutine  </em><code class="descname">ek_bulk_spin</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/ek_bulk_spin" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate bulk&#8217;s energy band using wannier TB method
also calculate spin direction for each band and each kpoint</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Use :</th><td class="field-body"><code class="xref f f-mod docutils literal"><span class="pre">wmpi</span></code>, <a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Call to:</th><td class="field-body"><a class="reference internal" href="#f/_/ham_bulk_old" title="f/_/ham_bulk_old"><code class="xref f f-func docutils literal"><span class="pre">ham_bulk_old()</span></code></a>, <a class="reference internal" href="#f/_/eigensystem_c" title="f/_/eigensystem_c"><code class="xref f f-func docutils literal"><span class="pre">eigensystem_c()</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/ek_bulk_fortomas">
<em class="property">subroutine  </em><code class="descname">ek_bulk_fortomas</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/ek_bulk_fortomas" title="Permalink to this definition">¶</a></dt>
<dd><p>only for IrF4 project</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Use :</th><td class="field-body"><code class="xref f f-mod docutils literal"><span class="pre">wmpi</span></code>, <a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Call to:</th><td class="field-body"><a class="reference internal" href="#f/_/ham_bulk_old" title="f/_/ham_bulk_old"><code class="xref f f-func docutils literal"><span class="pre">ham_bulk_old()</span></code></a>, <a class="reference internal" href="#f/_/eigensystem_c" title="f/_/eigensystem_c"><code class="xref f f-func docutils literal"><span class="pre">eigensystem_c()</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/ek_bulk_mirror_z">
<em class="property">subroutine  </em><code class="descname">ek_bulk_mirror_z</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/ek_bulk_mirror_z" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the eigenvalue of mirror z to label the energy bands</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Use :</th><td class="field-body"><code class="xref f f-mod docutils literal"><span class="pre">wmpi</span></code>, <a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Call to:</th><td class="field-body"><a class="reference internal" href="#f/_/ham_bulk_old" title="f/_/ham_bulk_old"><code class="xref f f-func docutils literal"><span class="pre">ham_bulk_old()</span></code></a>, <a class="reference internal" href="#f/_/mat_mul" title="f/_/mat_mul"><code class="xref f f-func docutils literal"><span class="pre">mat_mul()</span></code></a>, <a class="reference internal" href="#f/_/eigensystem_c" title="f/_/eigensystem_c"><code class="xref f f-func docutils literal"><span class="pre">eigensystem_c()</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/ek_bulk_mirror_x">
<em class="property">subroutine  </em><code class="descname">ek_bulk_mirror_x</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/ek_bulk_mirror_x" title="Permalink to this definition">¶</a></dt>
<dd><p>&gt; calculate bulk band for a given mirror symmetry</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Use :</th><td class="field-body"><code class="xref f f-mod docutils literal"><span class="pre">wmpi</span></code>, <a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Call to:</th><td class="field-body"><a class="reference internal" href="#f/_/ham_bulk_old" title="f/_/ham_bulk_old"><code class="xref f f-func docutils literal"><span class="pre">ham_bulk_old()</span></code></a>, <a class="reference internal" href="#f/_/inv" title="f/_/inv"><code class="xref f f-func docutils literal"><span class="pre">inv()</span></code></a>, <a class="reference internal" href="#f/_/mat_mul" title="f/_/mat_mul"><code class="xref f f-func docutils literal"><span class="pre">mat_mul()</span></code></a>, <a class="reference internal" href="#f/_/eigensystem_c" title="f/_/eigensystem_c"><code class="xref f f-func docutils literal"><span class="pre">eigensystem_c()</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="ek-bulk2d">
<h2>ek_bulk2D<a class="headerlink" href="#ek-bulk2d" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="ek-bulk-polar">
<h2>ek_bulk_polar<a class="headerlink" href="#ek-bulk-polar" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/_/ek_bulk_polar">
<em class="property">subroutine  </em><code class="descname">ek_bulk_polar</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/ek_bulk_polar" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate bulk&#8217;s energy band using wannier TB method.
This subroutine is very useful for nodal-line materials.
You have to define the center, k plane and radius
Copyright (c) 2010 QuanSheng Wu. All rights reserved.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Use :</th><td class="field-body"><code class="xref f f-mod docutils literal"><span class="pre">wmpi</span></code>, <a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Call to:</th><td class="field-body"><a class="reference internal" href="#f/_/direct_cart" title="f/_/direct_cart"><code class="xref f f-func docutils literal"><span class="pre">direct_cart()</span></code></a>, <a class="reference internal" href="#f/_/cart_direct" title="f/_/cart_direct"><code class="xref f f-func docutils literal"><span class="pre">cart_direct()</span></code></a>, <a class="reference internal" href="#f/_/ham_bulk" title="f/_/ham_bulk"><code class="xref f f-func docutils literal"><span class="pre">ham_bulk()</span></code></a>, <a class="reference internal" href="#f/_/eigensystem_c" title="f/_/eigensystem_c"><code class="xref f f-func docutils literal"><span class="pre">eigensystem_c()</span></code></a>, <a class="reference internal" href="#f/_/mat_mul" title="f/_/mat_mul"><code class="xref f f-func docutils literal"><span class="pre">mat_mul()</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/cart_direct">
<em class="property">subroutine  </em><code class="descname">cart_direct</code><span class="sig-paren">(</span><em>k1</em>, <em>k2</em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/cart_direct" title="Permalink to this definition">¶</a></dt>
<dd><p>Change the k points from the Cartisen coordinates
to reciprocal lattice coordinates (direct).
:p real k1(3) [in]: k2</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>k2</strong> (3)<em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></td>
</tr>
<tr class="field-even field"><th class="field-name">Use :</th><td class="field-body"><a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></td>
</tr>
<tr class="field-odd field"><th class="field-name">Called from:</th><td class="field-body"><a class="reference internal" href="#f/_/ek_bulk_polar" title="f/_/ek_bulk_polar"><code class="xref f f-func docutils literal"><span class="pre">ek_bulk_polar()</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Call to:</th><td class="field-body"><a class="reference internal" href="#f/_/inv_r" title="f/_/inv_r"><code class="xref f f-func docutils literal"><span class="pre">inv_r()</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/direct_cart">
<em class="property">subroutine  </em><code class="descname">direct_cart</code><span class="sig-paren">(</span><em>k1</em>, <em>k2</em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/direct_cart" title="Permalink to this definition">¶</a></dt>
<dd><p>Change the k points from the reciprocal lattice coordinates (direct).
to the Cartisen coordinates
:p real k1(3) [in]: k2</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>k2</strong> (3)<em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></td>
</tr>
<tr class="field-even field"><th class="field-name">Use :</th><td class="field-body"><a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></td>
</tr>
<tr class="field-odd field"><th class="field-name">Called from:</th><td class="field-body"><a class="reference internal" href="#f/_/ek_bulk_polar" title="f/_/ek_bulk_polar"><code class="xref f f-func docutils literal"><span class="pre">ek_bulk_polar()</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="ek-ribbon">
<h2>ek_ribbon<a class="headerlink" href="#ek-ribbon" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/_/ek_ribbon">
<em class="property">subroutine  </em><code class="descname">ek_ribbon</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/ek_ribbon" title="Permalink to this definition">¶</a></dt>
<dd><p>This subroutine is used to caculate energy dispersion
for 1D wire system.
Copyright (c) 2010 QuanSheng Wu. All rights reserved.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Use :</th><td class="field-body"><code class="xref f f-mod docutils literal"><span class="pre">wmpi</span></code>, <a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><a class="reference internal" href="#f/main" title="f/main"><code class="xref f f-prog docutils literal"><span class="pre">main</span></code></a></td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><a class="reference internal" href="#f/_/ham_ribbon" title="f/_/ham_ribbon"><code class="xref f f-func docutils literal"><span class="pre">ham_ribbon()</span></code></a>, <a class="reference internal" href="#f/_/eigensystem_c" title="f/_/eigensystem_c"><code class="xref f f-func docutils literal"><span class="pre">eigensystem_c()</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="ek-slab">
<h2>ek_slab<a class="headerlink" href="#ek-slab" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/_/ek_slab">
<em class="property">subroutine  </em><code class="descname">ek_slab</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/ek_slab" title="Permalink to this definition">¶</a></dt>
<dd><p>&gt; This subroutine is used for calculating energy
&gt; dispersion with wannier functions for 2D slab system</p>
<blockquote>
<div>Copyright (c) 2010 QuanSheng Wu. All rights reserved.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Use :</th><td class="field-body"><code class="xref f f-mod docutils literal"><span class="pre">wmpi</span></code>, <a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><a class="reference internal" href="#f/main" title="f/main"><code class="xref f f-prog docutils literal"><span class="pre">main</span></code></a></td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><a class="reference internal" href="#f/_/ham_slab" title="f/_/ham_slab"><code class="xref f f-func docutils literal"><span class="pre">ham_slab()</span></code></a>, <a class="reference internal" href="#f/_/ham_slab_parallel_b" title="f/_/ham_slab_parallel_b"><code class="xref f f-func docutils literal"><span class="pre">ham_slab_parallel_b()</span></code></a>, <a class="reference internal" href="#f/_/eigensystem_c" title="f/_/eigensystem_c"><code class="xref f f-func docutils literal"><span class="pre">eigensystem_c()</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/ek_slab_b">
<em class="property">subroutine  </em><code class="descname">ek_slab_b</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/ek_slab_b" title="Permalink to this definition">¶</a></dt>
<dd><p>&gt; This subroutine is used for calculating energy dispersion
&gt; with wannier functions in plane magnetic field
&gt;</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Use :</th><td class="field-body"><code class="xref f f-mod docutils literal"><span class="pre">wmpi</span></code>, <a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Call to:</th><td class="field-body"><a class="reference internal" href="#f/_/eigensystem_c" title="f/_/eigensystem_c"><code class="xref f f-func docutils literal"><span class="pre">eigensystem_c()</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="ekb-ribbon">
<h2>ekb_ribbon<a class="headerlink" href="#ekb-ribbon" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/_/ekb_ribbon">
<em class="property">subroutine  </em><code class="descname">ekb_ribbon</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/ekb_ribbon" title="Permalink to this definition">¶</a></dt>
<dd><p>This subroutine caculates energy dispersion for
1D wire system with axial magnetic field
Copyright (c) 2010 QuanSheng Wu. All rights reserved.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Use :</th><td class="field-body"><a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Call to:</th><td class="field-body"><a class="reference internal" href="#f/_/ham_ribbon_b" title="f/_/ham_ribbon_b"><code class="xref f f-func docutils literal"><span class="pre">ham_ribbon_b()</span></code></a>, <a class="reference internal" href="#f/_/eigensystem_c" title="f/_/eigensystem_c"><code class="xref f f-func docutils literal"><span class="pre">eigensystem_c()</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="fermiarc">
<h2>fermiarc<a class="headerlink" href="#fermiarc" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/_/fermiarc">
<em class="property">subroutine  </em><code class="descname">fermiarc</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/fermiarc" title="Permalink to this definition">¶</a></dt>
<dd><p>This subroutine calculates surface states using
iterative Green&#8217;s function method  &#8212;  J.Phys.F.Met.Phys.15(1985)851-858</p>
<p>History:</p>
<blockquote>
<div><p>by Quan Sheng Wu on 4/20/2010</p>
<blockquote>
<div>mpi version      4/21/2010</div></blockquote>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Use :</th><td class="field-body"><code class="xref f f-mod docutils literal"><span class="pre">wmpi</span></code>, <a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><a class="reference internal" href="#f/main" title="f/main"><code class="xref f f-prog docutils literal"><span class="pre">main</span></code></a></td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><a class="reference internal" href="#f/_/ham_qlayer2qlayer" title="f/_/ham_qlayer2qlayer"><code class="xref f f-func docutils literal"><span class="pre">ham_qlayer2qlayer()</span></code></a>, <a class="reference internal" href="#f/_/surfgreen_1985" title="f/_/surfgreen_1985"><code class="xref f f-func docutils literal"><span class="pre">surfgreen_1985()</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/fermiarc_jdos">
<em class="property">subroutine  </em><code class="descname">fermiarc_jdos</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/fermiarc_jdos" title="Permalink to this definition">¶</a></dt>
<dd><p>&gt; Calculation joint density of state
&gt; refs :<a class="reference external" href="http://science.sciencemag.org/content/sci/suppl/2016/03/09/351.6278.1184.DC1/Inoue.SM.pdf">http://science.sciencemag.org/content/sci/suppl/2016/03/09/351.6278.1184.DC1/Inoue.SM.pdf</a>
&gt; in this version, we also calculate the spin density jdos</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Use :</th><td class="field-body"><code class="xref f f-mod docutils literal"><span class="pre">wmpi</span></code>, <a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><a class="reference internal" href="#f/main" title="f/main"><code class="xref f f-prog docutils literal"><span class="pre">main</span></code></a></td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><a class="reference internal" href="#f/_/ham_qlayer2qlayer" title="f/_/ham_qlayer2qlayer"><code class="xref f f-func docutils literal"><span class="pre">ham_qlayer2qlayer()</span></code></a>, <a class="reference internal" href="#f/_/surfgreen_1985" title="f/_/surfgreen_1985"><code class="xref f f-func docutils literal"><span class="pre">surfgreen_1985()</span></code></a>, <a class="reference internal" href="#f/_/mat_mul" title="f/_/mat_mul"><code class="xref f f-func docutils literal"><span class="pre">mat_mul()</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="fermisurface">
<h2>fermisurface<a class="headerlink" href="#fermisurface" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/_/fermisurface3d">
<em class="property">subroutine  </em><code class="descname">fermisurface3d</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/fermisurface3d" title="Permalink to this definition">¶</a></dt>
<dd><p>This subroutine calculates 3D fermi surface in the 1st BZ using wannier TB method</p>
<p>Copyright (c) 2010 QuanSheng Wu. All rights reserved.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Use :</th><td class="field-body"><code class="xref f f-mod docutils literal"><span class="pre">wmpi</span></code>, <a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><a class="reference internal" href="#f/main" title="f/main"><code class="xref f f-prog docutils literal"><span class="pre">main</span></code></a></td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><a class="reference internal" href="#f/_/ham_bulk" title="f/_/ham_bulk"><code class="xref f f-func docutils literal"><span class="pre">ham_bulk()</span></code></a>, <a class="reference internal" href="#f/_/eigensystem_c" title="f/_/eigensystem_c"><code class="xref f f-func docutils literal"><span class="pre">eigensystem_c()</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/fermisurface">
<em class="property">subroutine  </em><code class="descname">fermisurface</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/fermisurface" title="Permalink to this definition">¶</a></dt>
<dd><p>This subroutine calculates 3D fermi surface in the a fixed k plane
using wannier TB method</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Use :</th><td class="field-body"><code class="xref f f-mod docutils literal"><span class="pre">wmpi</span></code>, <a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><a class="reference internal" href="#f/main" title="f/main"><code class="xref f f-prog docutils literal"><span class="pre">main</span></code></a></td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><a class="reference internal" href="#f/_/ham_bulk" title="f/_/ham_bulk"><code class="xref f f-func docutils literal"><span class="pre">ham_bulk()</span></code></a>, <a class="reference internal" href="#f/_/inv" title="f/_/inv"><code class="xref f f-func docutils literal"><span class="pre">inv()</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/gapshape3d">
<em class="property">subroutine  </em><code class="descname">gapshape3d</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/gapshape3d" title="Permalink to this definition">¶</a></dt>
<dd><p>This subroutine get the k points in the BZ at which the gap is smaller then
Gap_threshold</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Use :</th><td class="field-body"><code class="xref f f-mod docutils literal"><span class="pre">wmpi</span></code>, <a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><a class="reference internal" href="#f/main" title="f/main"><code class="xref f f-prog docutils literal"><span class="pre">main</span></code></a></td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><a class="reference internal" href="#f/_/ham_bulk" title="f/_/ham_bulk"><code class="xref f f-func docutils literal"><span class="pre">ham_bulk()</span></code></a>, <a class="reference internal" href="#f/_/eigensystem_c" title="f/_/eigensystem_c"><code class="xref f f-func docutils literal"><span class="pre">eigensystem_c()</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/gapshape">
<em class="property">subroutine  </em><code class="descname">gapshape</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/gapshape" title="Permalink to this definition">¶</a></dt>
<dd><p>This subroutine gets the gap at each k
points on the k plane specified by user</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Use :</th><td class="field-body"><code class="xref f f-mod docutils literal"><span class="pre">wmpi</span></code>, <a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><a class="reference internal" href="#f/main" title="f/main"><code class="xref f f-prog docutils literal"><span class="pre">main</span></code></a></td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><a class="reference internal" href="#f/_/ham_bulk" title="f/_/ham_bulk"><code class="xref f f-func docutils literal"><span class="pre">ham_bulk()</span></code></a>, <a class="reference internal" href="#f/_/eigensystem_c" title="f/_/eigensystem_c"><code class="xref f f-func docutils literal"><span class="pre">eigensystem_c()</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/get_fermilevel">
<em class="property">subroutine  </em><code class="descname">get_fermilevel</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/get_fermilevel" title="Permalink to this definition">¶</a></dt>
<dd><p>&gt; Calculate fermilevel for the given hamiltonian</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Use :</th><td class="field-body"><code class="xref f f-mod docutils literal"><span class="pre">wmpi</span></code>, <a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Call to:</th><td class="field-body"><a class="reference internal" href="#f/_/ham_bulk" title="f/_/ham_bulk"><code class="xref f f-func docutils literal"><span class="pre">ham_bulk()</span></code></a>, <a class="reference internal" href="#f/_/eigensystem_c" title="f/_/eigensystem_c"><code class="xref f f-func docutils literal"><span class="pre">eigensystem_c()</span></code></a>, <a class="reference internal" href="#f/_/fermi" title="f/_/fermi"><code class="xref f f-func docutils literal"><span class="pre">fermi()</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="f/_/fermi">
<em class="property">function  </em><code class="descname">fermi</code><span class="sig-paren">(</span><em>omega</em>, <em>beta</em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/fermi" title="Permalink to this definition">¶</a></dt>
<dd><p>This function sets the Fermi-Dirac distribution</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>omega</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>beta</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return:</th><td class="field-body"><p class="first"><strong>value</strong><em> [</em><em>real</em><em>]</em></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Use :</th><td class="field-body"><p class="first"><a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/_/get_fermilevel" title="f/_/get_fermilevel"><code class="xref f f-func docutils literal"><span class="pre">get_fermilevel()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="ham-bulk">
<h2>ham_bulk<a class="headerlink" href="#ham-bulk" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/_/ham_bulk">
<em class="property">subroutine  </em><code class="descname">ham_bulk</code><span class="sig-paren">(</span><em>k</em>, <em>hamk_bulk</em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/ham_bulk" title="Permalink to this definition">¶</a></dt>
<dd><p>This subroutine caculates Hamiltonian for
bulk system in the consideration of the atom&#8217;s position</p>
<p>History</p>
<blockquote>
<div>May/29/2011 by Quansheng Wu</div></blockquote>
<p>Copyright (c) 2010 QuanSheng Wu. All rights reserved.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>k</strong> (3)<em> [</em><em>real</em><em>]</em></li>
<li><strong>hamk_bulk</strong> (<a class="reference internal" href="#f/para/num_wann" title="f/para/num_wann">num_wann</a>,<a class="reference internal" href="#f/para/num_wann" title="f/para/num_wann">num_wann</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Use :</th><td class="field-body"><p class="first"><a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/_/psik_bulk" title="f/_/psik_bulk"><code class="xref f f-func docutils literal"><span class="pre">psik_bulk()</span></code></a>, <a class="reference internal" href="#f/_/dos_sub" title="f/_/dos_sub"><code class="xref f f-func docutils literal"><span class="pre">dos_sub()</span></code></a>, <a class="reference internal" href="#f/_/gapshape3d" title="f/_/gapshape3d"><code class="xref f f-func docutils literal"><span class="pre">gapshape3d()</span></code></a>, <a class="reference internal" href="#f/_/joint_dos" title="f/_/joint_dos"><code class="xref f f-func docutils literal"><span class="pre">joint_dos()</span></code></a>, <a class="reference internal" href="#f/_/gapshape" title="f/_/gapshape"><code class="xref f f-func docutils literal"><span class="pre">gapshape()</span></code></a>, <a class="reference internal" href="#f/_/get_fermilevel" title="f/_/get_fermilevel"><code class="xref f f-func docutils literal"><span class="pre">get_fermilevel()</span></code></a>, <a class="reference internal" href="#f/_/dos_joint_dos" title="f/_/dos_joint_dos"><code class="xref f f-func docutils literal"><span class="pre">dos_joint_dos()</span></code></a>, <code class="xref f f-func docutils literal"><span class="pre">ek_bulk2d_spin()</span></code>, <code class="xref f f-func docutils literal"><span class="pre">ek_bulk2d()</span></code>, <a class="reference internal" href="#f/_/ek_bulk_polar" title="f/_/ek_bulk_polar"><code class="xref f f-func docutils literal"><span class="pre">ek_bulk_polar()</span></code></a>, <a class="reference internal" href="#f/_/fermisurface3d" title="f/_/fermisurface3d"><code class="xref f f-func docutils literal"><span class="pre">fermisurface3d()</span></code></a>, <a class="reference internal" href="#f/_/psik" title="f/_/psik"><code class="xref f f-func docutils literal"><span class="pre">psik()</span></code></a>, <a class="reference internal" href="#f/_/fermisurface" title="f/_/fermisurface"><code class="xref f f-func docutils literal"><span class="pre">fermisurface()</span></code></a>, <a class="reference internal" href="#f/_/berryphase" title="f/_/berryphase"><code class="xref f f-func docutils literal"><span class="pre">berryphase()</span></code></a>, <a class="reference internal" href="#f/_/wannier_center3d" title="f/_/wannier_center3d"><code class="xref f f-func docutils literal"><span class="pre">wannier_center3d()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/ham_bulk_old">
<em class="property">subroutine  </em><code class="descname">ham_bulk_old</code><span class="sig-paren">(</span><em>k</em>, <em>hamk_bulk</em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/ham_bulk_old" title="Permalink to this definition">¶</a></dt>
<dd><p>This subroutine caculates Hamiltonian for
bulk system without the consideration of the atom&#8217;s position</p>
<p>History</p>
<blockquote>
<div>May/29/2011 by Quansheng Wu</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>k</strong> (3)<em> [</em><em>real</em><em>]</em></li>
<li><strong>hamk_bulk</strong> (<a class="reference internal" href="#f/para/num_wann" title="f/para/num_wann">num_wann</a>,<a class="reference internal" href="#f/para/num_wann" title="f/para/num_wann">num_wann</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Use :</th><td class="field-body"><p class="first"><a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/_/wannier_center3d_plane_mirror_minus" title="f/_/wannier_center3d_plane_mirror_minus"><code class="xref f f-func docutils literal"><span class="pre">wannier_center3d_plane_mirror_minus()</span></code></a>, <a class="reference internal" href="#f/_/ek_bulk_mirror_z" title="f/_/ek_bulk_mirror_z"><code class="xref f f-func docutils literal"><span class="pre">ek_bulk_mirror_z()</span></code></a>, <a class="reference internal" href="#f/_/wannier_center3d_plane_mirror_plus" title="f/_/wannier_center3d_plane_mirror_plus"><code class="xref f f-func docutils literal"><span class="pre">wannier_center3d_plane_mirror_plus()</span></code></a>, <a class="reference internal" href="#f/_/ek_bulk_mirror_x" title="f/_/ek_bulk_mirror_x"><code class="xref f f-func docutils literal"><span class="pre">ek_bulk_mirror_x()</span></code></a>, <a class="reference internal" href="#f/_/wannier_center3d_plane" title="f/_/wannier_center3d_plane"><code class="xref f f-func docutils literal"><span class="pre">wannier_center3d_plane()</span></code></a>, <a class="reference internal" href="#f/_/berry_curvarture" title="f/_/berry_curvarture"><code class="xref f f-func docutils literal"><span class="pre">berry_curvarture()</span></code></a>, <a class="reference internal" href="#f/_/ek_bulk_fortomas" title="f/_/ek_bulk_fortomas"><code class="xref f f-func docutils literal"><span class="pre">ek_bulk_fortomas()</span></code></a>, <a class="reference internal" href="#f/_/ek_bulk" title="f/_/ek_bulk"><code class="xref f f-func docutils literal"><span class="pre">ek_bulk()</span></code></a>, <a class="reference internal" href="#f/_/effective_mass_calc" title="f/_/effective_mass_calc"><code class="xref f f-func docutils literal"><span class="pre">effective_mass_calc()</span></code></a>, <a class="reference internal" href="#f/_/ek_bulk_spin" title="f/_/ek_bulk_spin"><code class="xref f f-func docutils literal"><span class="pre">ek_bulk_spin()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="ham-qlayer2qlayer">
<h2>ham_qlayer2qlayer<a class="headerlink" href="#ham-qlayer2qlayer" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/_/ham_qlayer2qlayer">
<em class="property">subroutine  </em><code class="descname">ham_qlayer2qlayer</code><span class="sig-paren">(</span><em>k</em>, <em>h00new</em>, <em>h01new</em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/ham_qlayer2qlayer" title="Permalink to this definition">¶</a></dt>
<dd><p>This subroutine caculates Hamiltonian between
slabs
4/23/2010 by QS Wu
Copyright (c) 2010 QuanSheng Wu. All rights reserved.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>k</strong> (2)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>h00new</strong> (<a class="reference internal" href="#f/para/ndim" title="f/para/ndim">ndim</a>,<a class="reference internal" href="#f/para/ndim" title="f/para/ndim">ndim</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>h01new</strong> (<a class="reference internal" href="#f/para/ndim" title="f/para/ndim">ndim</a>,<a class="reference internal" href="#f/para/ndim" title="f/para/ndim">ndim</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Use :</th><td class="field-body"><p class="first"><a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="#f/_/fermiarc" title="f/_/fermiarc"><code class="xref f f-func docutils literal"><span class="pre">fermiarc()</span></code></a>, <a class="reference internal" href="#f/_/spintext" title="f/_/spintext"><code class="xref f f-func docutils literal"><span class="pre">spintext()</span></code></a>, <code class="xref f f-func docutils literal"><span class="pre">surfstat2()</span></code>, <a class="reference internal" href="#f/_/surfstat" title="f/_/surfstat"><code class="xref f f-func docutils literal"><span class="pre">surfstat()</span></code></a>, <a class="reference internal" href="#f/_/fermiarc_jdos" title="f/_/fermiarc_jdos"><code class="xref f f-func docutils literal"><span class="pre">fermiarc_jdos()</span></code></a></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/_/latticetransform" title="f/_/latticetransform"><code class="xref f f-func docutils literal"><span class="pre">latticetransform()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/ham_qlayer2qlayer2">
<em class="property">subroutine  </em><code class="descname">ham_qlayer2qlayer2</code><span class="sig-paren">(</span><em>k</em>, <em>hij</em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/ham_qlayer2qlayer2" title="Permalink to this definition">¶</a></dt>
<dd><p>This subroutine caculates Hamiltonian between
slabs
4/23/2010 by QS Wu
Copyright (c) 2010 QuanSheng Wu. All rights reserved.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>k</strong> (2)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>hij</strong> (<a class="reference internal" href="#f/para/ijmax" title="f/para/ijmax">ijmax</a>-(-<a class="reference internal" href="#f/para/ijmax" title="f/para/ijmax">ijmax</a>)+1,<a class="reference internal" href="#f/para/num_wann" title="f/para/num_wann">num_wann</a>,<a class="reference internal" href="#f/para/num_wann" title="f/para/num_wann">num_wann</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Use :</th><td class="field-body"><p class="first"><a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="#f/_/ham_slab" title="f/_/ham_slab"><code class="xref f f-func docutils literal"><span class="pre">ham_slab()</span></code></a></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/_/latticetransform" title="f/_/latticetransform"><code class="xref f f-func docutils literal"><span class="pre">latticetransform()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/ham_qlayer2qlayerribbon">
<em class="property">subroutine  </em><code class="descname">ham_qlayer2qlayerribbon</code><span class="sig-paren">(</span><em>k</em>, <em>hij</em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/ham_qlayer2qlayerribbon" title="Permalink to this definition">¶</a></dt>
<dd><p>This subroutine caculates Hamiltonian between
ribbon
4/23/2010 by QS Wu
Copyright (c) 2010 QuanSheng Wu. All rights reserved.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>k</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>hij</strong> (<a class="reference internal" href="#f/para/ijmax" title="f/para/ijmax">ijmax</a>-(-<a class="reference internal" href="#f/para/ijmax" title="f/para/ijmax">ijmax</a>)+1,<a class="reference internal" href="#f/para/ijmax" title="f/para/ijmax">ijmax</a>-(-<a class="reference internal" href="#f/para/ijmax" title="f/para/ijmax">ijmax</a>)+1,<a class="reference internal" href="#f/para/num_wann" title="f/para/num_wann">num_wann</a>,<a class="reference internal" href="#f/para/num_wann" title="f/para/num_wann">num_wann</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Use :</th><td class="field-body"><p class="first"><a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="#f/_/ham_ribbon" title="f/_/ham_ribbon"><code class="xref f f-func docutils literal"><span class="pre">ham_ribbon()</span></code></a></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/_/latticetransform" title="f/_/latticetransform"><code class="xref f f-func docutils literal"><span class="pre">latticetransform()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/latticetransform">
<em class="property">subroutine  </em><code class="descname">latticetransform</code><span class="sig-paren">(</span><em>a</em>, <em>b</em>, <em>c</em>, <em>x</em>, <em>y</em>, <em>z</em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/latticetransform" title="Permalink to this definition">¶</a></dt>
<dd><p>&gt; use Umatrix to get the new representation of a vector in new basis
&gt; R= a*R1+b*R2+c*R3= x*R1&#8217;+y*R2&#8217;+z*R3&#8217;</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>a</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>b</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>c</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>x</strong><em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>y</strong><em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>z</strong><em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Use :</th><td class="field-body"><p class="first"><a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="#f/_/ham_3dlandau2" title="f/_/ham_3dlandau2"><code class="xref f f-func docutils literal"><span class="pre">ham_3dlandau2()</span></code></a>, <a class="reference internal" href="#f/_/ham_qlayer2qlayer2" title="f/_/ham_qlayer2qlayer2"><code class="xref f f-func docutils literal"><span class="pre">ham_qlayer2qlayer2()</span></code></a>, <a class="reference internal" href="#f/_/ham_3dlandau" title="f/_/ham_3dlandau"><code class="xref f f-func docutils literal"><span class="pre">ham_3dlandau()</span></code></a>, <a class="reference internal" href="#f/_/ham_slab_parallel_b" title="f/_/ham_slab_parallel_b"><code class="xref f f-func docutils literal"><span class="pre">ham_slab_parallel_b()</span></code></a>, <a class="reference internal" href="#f/_/ham_qlayer2qlayer" title="f/_/ham_qlayer2qlayer"><code class="xref f f-func docutils literal"><span class="pre">ham_qlayer2qlayer()</span></code></a>, <a class="reference internal" href="#f/_/ham_qlayer2qlayerribbon" title="f/_/ham_qlayer2qlayerribbon"><code class="xref f f-func docutils literal"><span class="pre">ham_qlayer2qlayerribbon()</span></code></a></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/_/inv_r" title="f/_/inv_r"><code class="xref f f-func docutils literal"><span class="pre">inv_r()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="ham-ribbon">
<h2>ham_ribbon<a class="headerlink" href="#ham-ribbon" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/_/ham_ribbon">
<em class="property">subroutine  </em><code class="descname">ham_ribbon</code><span class="sig-paren">(</span><em>k</em>, <em>hamk_ribbon</em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/ham_ribbon" title="Permalink to this definition">¶</a></dt>
<dd><p>This subroutine is used to caculate Hamiltonian for
ribbon system .</p>
<p>History</p>
<blockquote>
<div>4/15/2010 by Quansheng Wu</div></blockquote>
<p>Copyright (c) 2010 QuanSheng Wu. All rights reserved.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>k</strong><em> [</em><em>real</em><em>]</em></li>
<li><strong>hamk_ribbon</strong> (<a class="reference internal" href="#f/para/num_wann" title="f/para/num_wann">num_wann</a>*<a class="reference internal" href="#f/para/nslab1" title="f/para/nslab1">nslab1</a>*<a class="reference internal" href="#f/para/nslab2" title="f/para/nslab2">nslab2</a>,<a class="reference internal" href="#f/para/num_wann" title="f/para/num_wann">num_wann</a>*<a class="reference internal" href="#f/para/nslab1" title="f/para/nslab1">nslab1</a>*<a class="reference internal" href="#f/para/nslab2" title="f/para/nslab2">nslab2</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Use :</th><td class="field-body"><p class="first"><a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="#f/_/ek_ribbon" title="f/_/ek_ribbon"><code class="xref f f-func docutils literal"><span class="pre">ek_ribbon()</span></code></a></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/_/ham_qlayer2qlayerribbon" title="f/_/ham_qlayer2qlayerribbon"><code class="xref f f-func docutils literal"><span class="pre">ham_qlayer2qlayerribbon()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="ham-ribbon-b">
<h2>ham_ribbon_b<a class="headerlink" href="#ham-ribbon-b" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/_/ham_ribbon_b">
<em class="property">subroutine  </em><code class="descname">ham_ribbon_b</code><span class="sig-paren">(</span><em>bmag</em>, <em>k</em>, <em>hamk_ribbon</em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/ham_ribbon_b" title="Permalink to this definition">¶</a></dt>
<dd><p>This subroutine is used to caculate Hamiltonian for
ribbon system .
with magnetic field along x direction</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>bmag</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>k</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>hamk_ribbon</strong> (<a class="reference internal" href="#f/para/num_wann" title="f/para/num_wann">num_wann</a>*<a class="reference internal" href="#f/para/nslab1" title="f/para/nslab1">nslab1</a>*<a class="reference internal" href="#f/para/nslab2" title="f/para/nslab2">nslab2</a>,<a class="reference internal" href="#f/para/num_wann" title="f/para/num_wann">num_wann</a>*<a class="reference internal" href="#f/para/nslab1" title="f/para/nslab1">nslab1</a>*<a class="reference internal" href="#f/para/nslab2" title="f/para/nslab2">nslab2</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Use :</th><td class="field-body"><p class="first"><a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/_/ekb_ribbon" title="f/_/ekb_ribbon"><code class="xref f f-func docutils literal"><span class="pre">ekb_ribbon()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="ham-slab">
<h2>ham_slab<a class="headerlink" href="#ham-slab" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/_/ham_slab">
<em class="property">subroutine  </em><code class="descname">ham_slab</code><span class="sig-paren">(</span><em>k</em>, <em>hamk_slab</em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/ham_slab" title="Permalink to this definition">¶</a></dt>
<dd><p>This subroutine is used to caculate Hamiltonian for
slab system .</p>
<dl class="docutils">
<dt>History</dt>
<dd>4/18/2010 by Quansheng Wu</dd>
</dl>
<p>Copyright (c) 2010 QuanSheng Wu. All rights reserved.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>k</strong> (2)<em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></li>
<li><strong>hamk_slab</strong> (<a class="reference internal" href="#f/para/num_wann" title="f/para/num_wann">num_wann</a>*<a class="reference internal" href="#f/para/nslab" title="f/para/nslab">nslab</a>,<a class="reference internal" href="#f/para/num_wann" title="f/para/num_wann">num_wann</a>*<a class="reference internal" href="#f/para/nslab" title="f/para/nslab">nslab</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Use :</th><td class="field-body"><p class="first"><a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="#f/_/wannier_center2d" title="f/_/wannier_center2d"><code class="xref f f-func docutils literal"><span class="pre">wannier_center2d()</span></code></a>, <a class="reference internal" href="#f/_/wannier_center2d_alt" title="f/_/wannier_center2d_alt"><code class="xref f f-func docutils literal"><span class="pre">wannier_center2d_alt()</span></code></a>, <a class="reference internal" href="#f/_/ek_slab" title="f/_/ek_slab"><code class="xref f f-func docutils literal"><span class="pre">ek_slab()</span></code></a>, <a class="reference internal" href="#f/_/psik" title="f/_/psik"><code class="xref f f-func docutils literal"><span class="pre">psik()</span></code></a></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/_/ham_qlayer2qlayer2" title="f/_/ham_qlayer2qlayer2"><code class="xref f f-func docutils literal"><span class="pre">ham_qlayer2qlayer2()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/ham_slab_parallel_b">
<em class="property">subroutine  </em><code class="descname">ham_slab_parallel_b</code><span class="sig-paren">(</span><em>k</em>, <em>hamk_slab</em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/ham_slab_parallel_b" title="Permalink to this definition">¶</a></dt>
<dd><p>This subroutine is used to caculate Hamiltonian for
slab system .
&gt; for slab with in-plane magnetic field
&gt; the magnetic phase are chosen like this
&gt; phi_ij= alpha*[By*(xj-xi)*(zi+zj)-Bx*(yj-yi)*(zi+zj)]
&gt; x, z are in unit of Angstrom, Bx, By are in unit of Tesla
&gt; History :</p>
<blockquote>
<div>9/21/2015 by Quansheng Wu &#64;ETH Zurich</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>k</strong> (2)<em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></li>
<li><strong>hamk_slab</strong> (<a class="reference internal" href="#f/para/num_wann" title="f/para/num_wann">num_wann</a>*<a class="reference internal" href="#f/para/nslab" title="f/para/nslab">nslab</a>,<a class="reference internal" href="#f/para/num_wann" title="f/para/num_wann">num_wann</a>*<a class="reference internal" href="#f/para/nslab" title="f/para/nslab">nslab</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Use :</th><td class="field-body"><p class="first"><a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="#f/_/ek_slab" title="f/_/ek_slab"><code class="xref f f-func docutils literal"><span class="pre">ek_slab()</span></code></a></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/_/latticetransform" title="f/_/latticetransform"><code class="xref f f-func docutils literal"><span class="pre">latticetransform()</span></code></a>, <a class="reference internal" href="#f/_/rotate" title="f/_/rotate"><code class="xref f f-func docutils literal"><span class="pre">rotate()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="inverse">
<h2>inverse<a class="headerlink" href="#inverse" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/_/inv">
<em class="property">subroutine  </em><code class="descname">inv</code><span class="sig-paren">(</span><em>ndim</em>, <em>amat</em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/inv" title="Permalink to this definition">¶</a></dt>
<dd><p>A pack for Lapack subroutine zgesv to get the inverse of
a generic complex matrix</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ndim</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em></li>
<li><strong>amat</strong> (<a class="reference internal" href="#f/para/ndim" title="f/para/ndim">ndim</a>,<a class="reference internal" href="#f/para/ndim" title="f/para/ndim">ndim</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/_/surfgreen_1984" title="f/_/surfgreen_1984"><code class="xref f f-func docutils literal"><span class="pre">surfgreen_1984()</span></code></a>, <a class="reference internal" href="#f/_/surfgreen_1985" title="f/_/surfgreen_1985"><code class="xref f f-func docutils literal"><span class="pre">surfgreen_1985()</span></code></a>, <code class="xref f f-func docutils literal"><span class="pre">ek_bulk2d_spin()</span></code>, <a class="reference internal" href="#f/_/ek_bulk_mirror_x" title="f/_/ek_bulk_mirror_x"><code class="xref f f-func docutils literal"><span class="pre">ek_bulk_mirror_x()</span></code></a>, <a class="reference internal" href="#f/_/fermisurface" title="f/_/fermisurface"><code class="xref f f-func docutils literal"><span class="pre">fermisurface()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/inv_r">
<em class="property">subroutine  </em><code class="descname">inv_r</code><span class="sig-paren">(</span><em>ndim</em>, <em>amat</em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/inv_r" title="Permalink to this definition">¶</a></dt>
<dd><p>A pack for Lapack subroutine zgesv to get the inverse of
a generic real matrix</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ndim</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em></li>
<li><strong>amat</strong> (<a class="reference internal" href="#f/para/ndim" title="f/para/ndim">ndim</a>,<a class="reference internal" href="#f/para/ndim" title="f/para/ndim">ndim</a>)<em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/_/cart_direct" title="f/_/cart_direct"><code class="xref f f-func docutils literal"><span class="pre">cart_direct()</span></code></a>, <a class="reference internal" href="#f/_/wannier_center3d_plane_mirror_minus" title="f/_/wannier_center3d_plane_mirror_minus"><code class="xref f f-func docutils literal"><span class="pre">wannier_center3d_plane_mirror_minus()</span></code></a>, <a class="reference internal" href="#f/_/wannier_center2d_alt" title="f/_/wannier_center2d_alt"><code class="xref f f-func docutils literal"><span class="pre">wannier_center2d_alt()</span></code></a>, <a class="reference internal" href="#f/_/wannier_center3d_plane_mirror_plus" title="f/_/wannier_center3d_plane_mirror_plus"><code class="xref f f-func docutils literal"><span class="pre">wannier_center3d_plane_mirror_plus()</span></code></a>, <a class="reference internal" href="#f/_/wannier_center3d_plane" title="f/_/wannier_center3d_plane"><code class="xref f f-func docutils literal"><span class="pre">wannier_center3d_plane()</span></code></a>, <a class="reference internal" href="#f/_/cart_direct_rec" title="f/_/cart_direct_rec"><code class="xref f f-func docutils literal"><span class="pre">cart_direct_rec()</span></code></a>, <a class="reference internal" href="#f/_/effective_mass_calc" title="f/_/effective_mass_calc"><code class="xref f f-func docutils literal"><span class="pre">effective_mass_calc()</span></code></a>, <a class="reference internal" href="#f/_/cart_direct_real" title="f/_/cart_direct_real"><code class="xref f f-func docutils literal"><span class="pre">cart_direct_real()</span></code></a>, <a class="reference internal" href="#f/_/wannier_center3d" title="f/_/wannier_center3d"><code class="xref f f-func docutils literal"><span class="pre">wannier_center3d()</span></code></a>, <a class="reference internal" href="#f/_/latticetransform" title="f/_/latticetransform"><code class="xref f f-func docutils literal"><span class="pre">latticetransform()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="landau-level">
<h2>landau_level<a class="headerlink" href="#landau-level" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/_/landau_level_k">
<em class="property">subroutine  </em><code class="descname">landau_level_k</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/landau_level_k" title="Permalink to this definition">¶</a></dt>
<dd><p>&gt; calculate landau levels in 3D system in special k line
&gt; fix B field</p>
<p>&gt; the magnetic field is in the a1 a2 plane</p>
<p>&gt; B= (B costheta, B sintheta, 0)</p>
<p>&gt; construct on Dec 8 2015</p>
<p>&gt; By QuanSheng Wu at ETH Zurich Honggerberg</p>
<blockquote>
<div>Copyright (c) 2010 QuanSheng Wu. All rights reserved.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Use :</th><td class="field-body"><a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Call to:</th><td class="field-body"><a class="reference internal" href="#f/_/ham_3dlandau2" title="f/_/ham_3dlandau2"><code class="xref f f-func docutils literal"><span class="pre">ham_3dlandau2()</span></code></a>, <a class="reference internal" href="#f/_/eigensystem_c" title="f/_/eigensystem_c"><code class="xref f f-func docutils literal"><span class="pre">eigensystem_c()</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/landau_level_b">
<em class="property">subroutine  </em><code class="descname">landau_level_b</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/landau_level_b" title="Permalink to this definition">¶</a></dt>
<dd><p>&gt; calculate landau levels in 3D system for different B
&gt; fix k point, usually Gamma point</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Use :</th><td class="field-body"><a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Call to:</th><td class="field-body"><a class="reference internal" href="#f/_/ham_3dlandau2" title="f/_/ham_3dlandau2"><code class="xref f f-func docutils literal"><span class="pre">ham_3dlandau2()</span></code></a>, <a class="reference internal" href="#f/_/eigensystem_c" title="f/_/eigensystem_c"><code class="xref f f-func docutils literal"><span class="pre">eigensystem_c()</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/ham_3dlandau">
<em class="property">subroutine  </em><code class="descname">ham_3dlandau</code><span class="sig-paren">(</span><em>ndimq</em>, <em>nq</em>, <em>k</em>, <em>ham_landau</em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/ham_3dlandau" title="Permalink to this definition">¶</a></dt>
<dd><p>&gt; calculate hamiltonian for landau levels
&gt; consider the internal atom&#8217;s position</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ndimq</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>nq</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>k</strong> (3)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>ham_landau</strong> (ndimq,ndimq)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Use :</th><td class="field-body"><p class="first"><a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/_/latticetransform" title="f/_/latticetransform"><code class="xref f f-func docutils literal"><span class="pre">latticetransform()</span></code></a>, <a class="reference internal" href="#f/_/rotate" title="f/_/rotate"><code class="xref f f-func docutils literal"><span class="pre">rotate()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/ham_3dlandau2">
<em class="property">subroutine  </em><code class="descname">ham_3dlandau2</code><span class="sig-paren">(</span><em>ndimq</em>, <em>nq</em>, <em>k</em>, <em>ham_landau</em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/ham_3dlandau2" title="Permalink to this definition">¶</a></dt>
<dd><p>&gt; calculate hamiltonian for landau levels
&gt; don&#8217;t consider the internal atom&#8217;s position</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ndimq</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>nq</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>k</strong> (3)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>ham_landau</strong> (ndimq,ndimq)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Use :</th><td class="field-body"><p class="first"><a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="#f/_/landau_level_k" title="f/_/landau_level_k"><code class="xref f f-func docutils literal"><span class="pre">landau_level_k()</span></code></a>, <a class="reference internal" href="#f/_/landau_level_b" title="f/_/landau_level_b"><code class="xref f f-func docutils literal"><span class="pre">landau_level_b()</span></code></a></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/_/latticetransform" title="f/_/latticetransform"><code class="xref f f-func docutils literal"><span class="pre">latticetransform()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="main">
<h2>main<a class="headerlink" href="#main" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Program</p>
<dl class="program">
<dt>
<em class="property">program  </em><code class="descname">main</code></dt>
<dd><p>Main program of a set of tools based on Wannier90 TB</p>
<p>constructed by Q.S.Wu on 4/9/2010</p>
<p>change      by Q.S.Wu on 4/22/2010</p>
<p>changed     by Q.S.wu on July/15/2010</p>
<p>version     HmnR.data  contains soc</p>
<p>mpi-version is  tested , please report bugs to QSWU</p>
<p>Jan 25 2015 by Q.S.Wu at ETH Zurich</p>
<p><a class="reference external" href="mailto:wuquansheng&#37;&#52;&#48;gmail&#46;com">wuquansheng<span>&#64;</span>gmail<span>&#46;</span>com</a></p>
<p>Copyright (c) 2010 QuanSheng Wu. All rights reserved.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Use :</th><td class="field-body"><code class="xref f f-mod docutils literal"><span class="pre">wmpi</span></code>, <a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Call to:</th><td class="field-body"><a class="reference internal" href="#f/_/now" title="f/_/now"><code class="xref f f-func docutils literal"><span class="pre">now()</span></code></a>, <a class="reference internal" href="#f/_/header" title="f/_/header"><code class="xref f f-func docutils literal"><span class="pre">header()</span></code></a>, <a class="reference internal" href="#f/_/readinput" title="f/_/readinput"><code class="xref f f-func docutils literal"><span class="pre">readinput()</span></code></a>, <code class="xref f f-func docutils literal"><span class="pre">readhmnr()</span></code>, <a class="reference internal" href="#f/_/ek_bulk" title="f/_/ek_bulk"><code class="xref f f-func docutils literal"><span class="pre">ek_bulk()</span></code></a>, <a class="reference internal" href="#f/_/print_time_cost" title="f/_/print_time_cost"><code class="xref f f-func docutils literal"><span class="pre">print_time_cost()</span></code></a>, <a class="reference internal" href="#f/_/fermisurface" title="f/_/fermisurface"><code class="xref f f-func docutils literal"><span class="pre">fermisurface()</span></code></a>, <a class="reference internal" href="#f/_/fermisurface3d" title="f/_/fermisurface3d"><code class="xref f f-func docutils literal"><span class="pre">fermisurface3d()</span></code></a>, <a class="reference internal" href="#f/_/dos_joint_dos" title="f/_/dos_joint_dos"><code class="xref f f-func docutils literal"><span class="pre">dos_joint_dos()</span></code></a>, <a class="reference internal" href="#f/_/dos_sub" title="f/_/dos_sub"><code class="xref f f-func docutils literal"><span class="pre">dos_sub()</span></code></a>, <a class="reference internal" href="#f/_/joint_dos" title="f/_/joint_dos"><code class="xref f f-func docutils literal"><span class="pre">joint_dos()</span></code></a>, <a class="reference internal" href="#f/_/effective_mass_calc" title="f/_/effective_mass_calc"><code class="xref f f-func docutils literal"><span class="pre">effective_mass_calc()</span></code></a>, <a class="reference internal" href="#f/_/gapshape" title="f/_/gapshape"><code class="xref f f-func docutils literal"><span class="pre">gapshape()</span></code></a>, <a class="reference internal" href="#f/_/gapshape3d" title="f/_/gapshape3d"><code class="xref f f-func docutils literal"><span class="pre">gapshape3d()</span></code></a>, <a class="reference internal" href="#f/_/ek_slab" title="f/_/ek_slab"><code class="xref f f-func docutils literal"><span class="pre">ek_slab()</span></code></a>, <a class="reference internal" href="#f/_/berry_curvarture" title="f/_/berry_curvarture"><code class="xref f f-func docutils literal"><span class="pre">berry_curvarture()</span></code></a>, <a class="reference internal" href="#f/_/ek_ribbon" title="f/_/ek_ribbon"><code class="xref f f-func docutils literal"><span class="pre">ek_ribbon()</span></code></a>, <a class="reference internal" href="#f/_/wannier_center3d_plane" title="f/_/wannier_center3d_plane"><code class="xref f f-func docutils literal"><span class="pre">wannier_center3d_plane()</span></code></a>, <a class="reference internal" href="#f/_/berryphase" title="f/_/berryphase"><code class="xref f f-func docutils literal"><span class="pre">berryphase()</span></code></a>, <a class="reference internal" href="#f/_/surfstat" title="f/_/surfstat"><code class="xref f f-func docutils literal"><span class="pre">surfstat()</span></code></a>, <a class="reference internal" href="#f/_/fermiarc" title="f/_/fermiarc"><code class="xref f f-func docutils literal"><span class="pre">fermiarc()</span></code></a>, <a class="reference internal" href="#f/_/fermiarc_jdos" title="f/_/fermiarc_jdos"><code class="xref f f-func docutils literal"><span class="pre">fermiarc_jdos()</span></code></a>, <a class="reference internal" href="#f/_/spintext" title="f/_/spintext"><code class="xref f f-func docutils literal"><span class="pre">spintext()</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="mat-mul">
<h2>mat_mul<a class="headerlink" href="#mat-mul" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/_/mat_mul">
<em class="property">subroutine  </em><code class="descname">mat_mul</code><span class="sig-paren">(</span><em>nmatdim</em>, <em>a</em>, <em>b</em>, <em>c</em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/mat_mul" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs matrix-matrix multiply,
C=A*B</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>nmatdim</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em></li>
<li><strong>a</strong> (nmatdim,nmatdim)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>b</strong> (nmatdim,nmatdim)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>c</strong> (nmatdim,nmatdim)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Use :</th><td class="field-body"><p class="first"><a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a> (<a class="reference internal" href="#f/para/dp" title="f/para/dp"><code class="xref f f-func docutils literal"><span class="pre">dp()</span></code></a>)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/_/surfgreen_1985" title="f/_/surfgreen_1985"><code class="xref f f-func docutils literal"><span class="pre">surfgreen_1985()</span></code></a>, <a class="reference internal" href="#f/_/orbital_momenta" title="f/_/orbital_momenta"><code class="xref f f-func docutils literal"><span class="pre">orbital_momenta()</span></code></a>, <a class="reference internal" href="#f/_/wannier_center2d" title="f/_/wannier_center2d"><code class="xref f f-func docutils literal"><span class="pre">wannier_center2d()</span></code></a>, <a class="reference internal" href="#f/_/spintext" title="f/_/spintext"><code class="xref f f-func docutils literal"><span class="pre">spintext()</span></code></a>, <a class="reference internal" href="#f/_/wannier_center3d_plane_mirror_minus" title="f/_/wannier_center3d_plane_mirror_minus"><code class="xref f f-func docutils literal"><span class="pre">wannier_center3d_plane_mirror_minus()</span></code></a>, <code class="xref f f-func docutils literal"><span class="pre">ek_bulk2d_spin()</span></code>, <a class="reference internal" href="#f/_/wannier_center2d_alt" title="f/_/wannier_center2d_alt"><code class="xref f f-func docutils literal"><span class="pre">wannier_center2d_alt()</span></code></a>, <a class="reference internal" href="#f/_/ek_bulk_mirror_z" title="f/_/ek_bulk_mirror_z"><code class="xref f f-func docutils literal"><span class="pre">ek_bulk_mirror_z()</span></code></a>, <a class="reference internal" href="#f/_/wannier_center3d_plane_mirror_plus" title="f/_/wannier_center3d_plane_mirror_plus"><code class="xref f f-func docutils literal"><span class="pre">wannier_center3d_plane_mirror_plus()</span></code></a>, <a class="reference internal" href="#f/_/ek_bulk_mirror_x" title="f/_/ek_bulk_mirror_x"><code class="xref f f-func docutils literal"><span class="pre">ek_bulk_mirror_x()</span></code></a>, <a class="reference internal" href="#f/_/ek_bulk_polar" title="f/_/ek_bulk_polar"><code class="xref f f-func docutils literal"><span class="pre">ek_bulk_polar()</span></code></a>, <a class="reference internal" href="#f/_/fermiarc_jdos" title="f/_/fermiarc_jdos"><code class="xref f f-func docutils literal"><span class="pre">fermiarc_jdos()</span></code></a>, <a class="reference internal" href="#f/_/wannier_center3d_plane" title="f/_/wannier_center3d_plane"><code class="xref f f-func docutils literal"><span class="pre">wannier_center3d_plane()</span></code></a>, <a class="reference internal" href="#f/_/berry_curvarture" title="f/_/berry_curvarture"><code class="xref f f-func docutils literal"><span class="pre">berry_curvarture()</span></code></a>, <a class="reference internal" href="#f/_/wannier_center3d" title="f/_/wannier_center3d"><code class="xref f f-func docutils literal"><span class="pre">wannier_center3d()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/zgesvd_pack">
<em class="property">subroutine  </em><code class="descname">zgesvd_pack</code><span class="sig-paren">(</span><em>m</em>, <em>a</em>, <em>u</em>, <em>s</em>, <em>vt</em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/zgesvd_pack" title="Permalink to this definition">¶</a></dt>
<dd><p>&gt; ZGESVD computes the singular value decomposition (SVD) for GE matrices,
&gt; In this pack, we assume the matrix A is a square matrix, the dimension
&gt; of row and column are the same
&gt; A = U * SIGMA * conjugate-transpose(V),
&gt; VT= conjugate-transpose(V)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>m</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em></li>
<li><strong>a</strong> (m,m)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></li>
<li><strong>u</strong> (m,m)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>s</strong> (m,m)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>vt</strong> (m,m)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Use :</th><td class="field-body"><p class="first"><a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a> (<a class="reference internal" href="#f/para/dp" title="f/para/dp"><code class="xref f f-func docutils literal"><span class="pre">dp()</span></code></a>)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/_/wannier_center2d" title="f/_/wannier_center2d"><code class="xref f f-func docutils literal"><span class="pre">wannier_center2d()</span></code></a>, <a class="reference internal" href="#f/_/wannier_center3d_plane_mirror_minus" title="f/_/wannier_center3d_plane_mirror_minus"><code class="xref f f-func docutils literal"><span class="pre">wannier_center3d_plane_mirror_minus()</span></code></a>, <a class="reference internal" href="#f/_/wannier_center2d_alt" title="f/_/wannier_center2d_alt"><code class="xref f f-func docutils literal"><span class="pre">wannier_center2d_alt()</span></code></a>, <a class="reference internal" href="#f/_/wannier_center3d_plane_mirror_plus" title="f/_/wannier_center3d_plane_mirror_plus"><code class="xref f f-func docutils literal"><span class="pre">wannier_center3d_plane_mirror_plus()</span></code></a>, <a class="reference internal" href="#f/_/wannier_center3d_plane" title="f/_/wannier_center3d_plane"><code class="xref f f-func docutils literal"><span class="pre">wannier_center3d_plane()</span></code></a>, <a class="reference internal" href="#f/_/wannier_center3d" title="f/_/wannier_center3d"><code class="xref f f-func docutils literal"><span class="pre">wannier_center3d()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/zhpevx_pack">
<em class="property">subroutine  </em><code class="descname">zhpevx_pack</code><span class="sig-paren">(</span><em>mat</em>, <em>ndim</em>, <em>eig</em>, <em>rot</em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/zhpevx_pack" title="Permalink to this definition">¶</a></dt>
<dd><p>Diagonalize the ndim x ndim  hermitian matrix &#8216;mat&#8217; and
return the eigenvalues &#8216;eig&#8217; and the unitary rotation &#8216;rot&#8217;</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>mat</strong> (<a class="reference internal" href="#f/para/ndim" title="f/para/ndim">ndim</a>,<a class="reference internal" href="#f/para/ndim" title="f/para/ndim">ndim</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>ndim</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em></li>
<li><strong>eig</strong> (<a class="reference internal" href="#f/para/ndim" title="f/para/ndim">ndim</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>rot</strong> (<a class="reference internal" href="#f/para/ndim" title="f/para/ndim">ndim</a>,<a class="reference internal" href="#f/para/ndim" title="f/para/ndim">ndim</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Use :</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a> (<a class="reference internal" href="#f/para/dp" title="f/para/dp"><code class="xref f f-func docutils literal"><span class="pre">dp()</span></code></a>, <code class="xref f f-func docutils literal"><span class="pre">stdout()</span></code>)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="orbital-momenta">
<h2>orbital_momenta<a class="headerlink" href="#orbital-momenta" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/_/orbital_momenta">
<em class="property">subroutine  </em><code class="descname">orbital_momenta</code><span class="sig-paren">(</span><em>k</em>, <em>eigvec</em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/orbital_momenta" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the orbital momenta for each band at Gamma point</p>
<p>2016 by QuanSheng Wu &#64; ETHZ</p>
<p><a class="reference external" href="mailto:wuquansheng&#37;&#52;&#48;gmail&#46;com">wuquansheng<span>&#64;</span>gmail<span>&#46;</span>com</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>k</strong> (2)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>eigvec</strong> (<a class="reference internal" href="#f/para/num_wann" title="f/para/num_wann">num_wann</a>,<a class="reference internal" href="#f/para/num_wann" title="f/para/num_wann">num_wann</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Use :</th><td class="field-body"><p class="first"><a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="#f/_/ek_bulk" title="f/_/ek_bulk"><code class="xref f f-func docutils literal"><span class="pre">ek_bulk()</span></code></a></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/_/mat_mul" title="f/_/mat_mul"><code class="xref f f-func docutils literal"><span class="pre">mat_mul()</span></code></a>, <a class="reference internal" href="#f/_/eigensystem_c" title="f/_/eigensystem_c"><code class="xref f f-func docutils literal"><span class="pre">eigensystem_c()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="psi">
<h2>psi<a class="headerlink" href="#psi" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/_/psik">
<em class="property">subroutine  </em><code class="descname">psik</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/psik" title="Permalink to this definition">¶</a></dt>
<dd><p>Psik calculates the eigenvector for a given k point and energe band
for 2D slab system</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Use :</th><td class="field-body"><a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a> (<a class="reference internal" href="#f/para/cpuid" title="f/para/cpuid"><code class="xref f f-func docutils literal"><span class="pre">cpuid()</span></code></a>, <a class="reference internal" href="#f/para/nslab" title="f/para/nslab"><code class="xref f f-func docutils literal"><span class="pre">nslab()</span></code></a>, <code class="xref f f-func docutils literal"><span class="pre">stdout()</span></code>, <a class="reference internal" href="#f/para/dp" title="f/para/dp"><code class="xref f f-func docutils literal"><span class="pre">dp()</span></code></a>, <a class="reference internal" href="#f/para/num_wann" title="f/para/num_wann"><code class="xref f f-func docutils literal"><span class="pre">num_wann()</span></code></a>)</td>
</tr>
<tr class="field-even field"><th class="field-name">Call to:</th><td class="field-body"><a class="reference internal" href="#f/_/ham_slab" title="f/_/ham_slab"><code class="xref f f-func docutils literal"><span class="pre">ham_slab()</span></code></a>, <a class="reference internal" href="#f/_/eigensystem_c" title="f/_/eigensystem_c"><code class="xref f f-func docutils literal"><span class="pre">eigensystem_c()</span></code></a>, <a class="reference internal" href="#f/_/ham_bulk" title="f/_/ham_bulk"><code class="xref f f-func docutils literal"><span class="pre">ham_bulk()</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/psik_bulk">
<em class="property">subroutine  </em><code class="descname">psik_bulk</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/psik_bulk" title="Permalink to this definition">¶</a></dt>
<dd><p>Psik calculates the eigenvector for a given k point and energe band
for 3D bulk system</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Use :</th><td class="field-body"><a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a> (<a class="reference internal" href="#f/para/cpuid" title="f/para/cpuid"><code class="xref f f-func docutils literal"><span class="pre">cpuid()</span></code></a>, <a class="reference internal" href="#f/para/numoccupied" title="f/para/numoccupied"><code class="xref f f-func docutils literal"><span class="pre">numoccupied()</span></code></a>, <code class="xref f f-func docutils literal"><span class="pre">stdout()</span></code>, <a class="reference internal" href="#f/para/dp" title="f/para/dp"><code class="xref f f-func docutils literal"><span class="pre">dp()</span></code></a>, <a class="reference internal" href="#f/para/num_wann" title="f/para/num_wann"><code class="xref f f-func docutils literal"><span class="pre">num_wann()</span></code></a>)</td>
</tr>
<tr class="field-even field"><th class="field-name">Call to:</th><td class="field-body"><a class="reference internal" href="#f/_/ham_bulk" title="f/_/ham_bulk"><code class="xref f f-func docutils literal"><span class="pre">ham_bulk()</span></code></a>, <a class="reference internal" href="#f/_/eigensystem_c" title="f/_/eigensystem_c"><code class="xref f f-func docutils literal"><span class="pre">eigensystem_c()</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="readhmnr">
<h2>readHmnR<a class="headerlink" href="#readhmnr" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="readinput">
<h2>readinput<a class="headerlink" href="#readinput" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/_/readinput">
<em class="property">subroutine  </em><code class="descname">readinput</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/readinput" title="Permalink to this definition">¶</a></dt>
<dd><p>Read in the control paramters from input.dat,
and set default values if not specified in the input.dat</p>
<p>Constructed on 4/22/2010 by QS.Wu</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Use :</th><td class="field-body"><code class="xref f f-mod docutils literal"><span class="pre">wmpi</span></code>, <a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><a class="reference internal" href="#f/main" title="f/main"><code class="xref f f-prog docutils literal"><span class="pre">main</span></code></a></td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><a class="reference internal" href="#f/_/cart_direct_real" title="f/_/cart_direct_real"><code class="xref f f-func docutils literal"><span class="pre">cart_direct_real()</span></code></a>, <a class="reference internal" href="#f/_/direct_cart_real" title="f/_/direct_cart_real"><code class="xref f f-func docutils literal"><span class="pre">direct_cart_real()</span></code></a>, <a class="reference internal" href="#f/_/norm" title="f/_/norm"><code class="xref f f-func docutils literal"><span class="pre">norm()</span></code></a>, <a class="reference internal" href="#f/_/rotate" title="f/_/rotate"><code class="xref f f-func docutils literal"><span class="pre">rotate()</span></code></a>, <a class="reference internal" href="#f/_/direct_cart_rec" title="f/_/direct_cart_rec"><code class="xref f f-func docutils literal"><span class="pre">direct_cart_rec()</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="f/_/norm">
<em class="property">function  </em><code class="descname">norm</code><span class="sig-paren">(</span><em>r1</em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/norm" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>r1</strong> (3)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></td>
</tr>
<tr class="field-even field"><th class="field-name">Return:</th><td class="field-body"><strong>norm</strong><em> [</em><em>real</em><em>]</em></td>
</tr>
<tr class="field-odd field"><th class="field-name">Use :</th><td class="field-body"><a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a> (<a class="reference internal" href="#f/para/dp" title="f/para/dp"><code class="xref f f-func docutils literal"><span class="pre">dp()</span></code></a>)</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><a class="reference internal" href="#f/_/readinput" title="f/_/readinput"><code class="xref f f-func docutils literal"><span class="pre">readinput()</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/rotate">
<em class="property">subroutine  </em><code class="descname">rotate</code><span class="sig-paren">(</span><em>r1</em>, <em>r2</em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/rotate" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>r1</strong> (3)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>r2</strong> (3)<em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Use :</th><td class="field-body"><p class="first"><a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a> (<a class="reference internal" href="#f/para/urot" title="f/para/urot"><code class="xref f f-func docutils literal"><span class="pre">urot()</span></code></a>, <a class="reference internal" href="#f/para/dp" title="f/para/dp"><code class="xref f f-func docutils literal"><span class="pre">dp()</span></code></a>)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/_/ham_3dlandau" title="f/_/ham_3dlandau"><code class="xref f f-func docutils literal"><span class="pre">ham_3dlandau()</span></code></a>, <a class="reference internal" href="#f/_/ham_slab_parallel_b" title="f/_/ham_slab_parallel_b"><code class="xref f f-func docutils literal"><span class="pre">ham_slab_parallel_b()</span></code></a>, <a class="reference internal" href="#f/_/readinput" title="f/_/readinput"><code class="xref f f-func docutils literal"><span class="pre">readinput()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/cart_direct_real">
<em class="property">subroutine  </em><code class="descname">cart_direct_real</code><span class="sig-paren">(</span><em>r1</em>, <em>r2</em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/cart_direct_real" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>r1</strong> (3)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>r2</strong> (3)<em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Use :</th><td class="field-body"><p class="first"><a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="#f/_/readinput" title="f/_/readinput"><code class="xref f f-func docutils literal"><span class="pre">readinput()</span></code></a></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/_/inv_r" title="f/_/inv_r"><code class="xref f f-func docutils literal"><span class="pre">inv_r()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/direct_cart_real">
<em class="property">subroutine  </em><code class="descname">direct_cart_real</code><span class="sig-paren">(</span><em>r1</em>, <em>r2</em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/direct_cart_real" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>r1</strong> (3)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>r2</strong> (3)<em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Use :</th><td class="field-body"><p class="first"><a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/_/readinput" title="f/_/readinput"><code class="xref f f-func docutils literal"><span class="pre">readinput()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/cart_direct_rec">
<em class="property">subroutine  </em><code class="descname">cart_direct_rec</code><span class="sig-paren">(</span><em>k1</em>, <em>k2</em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/cart_direct_rec" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>k1</strong> (3)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>k2</strong> (3)<em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Use :</th><td class="field-body"><p class="first"><a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="#f/_/effective_mass_calc" title="f/_/effective_mass_calc"><code class="xref f f-func docutils literal"><span class="pre">effective_mass_calc()</span></code></a></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/_/inv_r" title="f/_/inv_r"><code class="xref f f-func docutils literal"><span class="pre">inv_r()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/direct_cart_rec">
<em class="property">subroutine  </em><code class="descname">direct_cart_rec</code><span class="sig-paren">(</span><em>k1</em>, <em>k2</em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/direct_cart_rec" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>k1</strong> (3)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>k2</strong> (3)<em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Use :</th><td class="field-body"><p class="first"><a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/_/readinput" title="f/_/readinput"><code class="xref f f-func docutils literal"><span class="pre">readinput()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="spintexture">
<h2>spintexture<a class="headerlink" href="#spintexture" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/_/spintext">
<em class="property">subroutine  </em><code class="descname">spintext</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/spintext" title="Permalink to this definition">¶</a></dt>
<dd><p>spintext calculates spin texture of
the surface states using Green&#8217;s function</p>
<p>Constructed by QS.Wu on July/20/2010  10:26:13</p>
<p>Modified by QS.Wu on June/4/2016 in Jouvence Montreal Canada</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Use :</th><td class="field-body"><code class="xref f f-mod docutils literal"><span class="pre">wmpi</span></code>, <a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><a class="reference internal" href="#f/main" title="f/main"><code class="xref f f-prog docutils literal"><span class="pre">main</span></code></a></td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><a class="reference internal" href="#f/_/ham_qlayer2qlayer" title="f/_/ham_qlayer2qlayer"><code class="xref f f-func docutils literal"><span class="pre">ham_qlayer2qlayer()</span></code></a>, <a class="reference internal" href="#f/_/surfgreen_1985" title="f/_/surfgreen_1985"><code class="xref f f-func docutils literal"><span class="pre">surfgreen_1985()</span></code></a>, <a class="reference internal" href="#f/_/mat_mul" title="f/_/mat_mul"><code class="xref f f-func docutils literal"><span class="pre">mat_mul()</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="surfgreen">
<h2>surfgreen<a class="headerlink" href="#surfgreen" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/_/surfgreen_1985">
<em class="property">subroutine  </em><code class="descname">surfgreen_1985</code><span class="sig-paren">(</span><em>omega</em>, <em>gll</em>, <em>grr</em>, <em>gb</em>, <em>h00</em>, <em>h01</em>, <em>ones</em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/surfgreen_1985" title="Permalink to this definition">¶</a></dt>
<dd><p>surfgreen_1985 calculates surface states using
Green&#8217;s function method  &#8212;  J.Phys.F.Met.Phys.15(1985)851-858</p>
<p>Using eq.(11) and eq.(13) (16), (17)</p>
<p>History:</p>
<blockquote>
<div>by Quan Sheng Wu on Oct/17/2012</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>omega</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>gll</strong> (<a class="reference internal" href="#f/para/ndim" title="f/para/ndim">ndim</a>,<a class="reference internal" href="#f/para/ndim" title="f/para/ndim">ndim</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></li>
<li><strong>grr</strong> (<a class="reference internal" href="#f/para/ndim" title="f/para/ndim">ndim</a>,<a class="reference internal" href="#f/para/ndim" title="f/para/ndim">ndim</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></li>
<li><strong>gb</strong> (<a class="reference internal" href="#f/para/ndim" title="f/para/ndim">ndim</a>,<a class="reference internal" href="#f/para/ndim" title="f/para/ndim">ndim</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></li>
<li><strong>h00</strong> (<a class="reference internal" href="#f/para/ndim" title="f/para/ndim">ndim</a>,<a class="reference internal" href="#f/para/ndim" title="f/para/ndim">ndim</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>h01</strong> (<a class="reference internal" href="#f/para/ndim" title="f/para/ndim">ndim</a>,<a class="reference internal" href="#f/para/ndim" title="f/para/ndim">ndim</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>ones</strong> (<a class="reference internal" href="#f/para/ndim" title="f/para/ndim">ndim</a>,<a class="reference internal" href="#f/para/ndim" title="f/para/ndim">ndim</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Use :</th><td class="field-body"><p class="first"><a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="#f/_/fermiarc" title="f/_/fermiarc"><code class="xref f f-func docutils literal"><span class="pre">fermiarc()</span></code></a>, <a class="reference internal" href="#f/_/spintext" title="f/_/spintext"><code class="xref f f-func docutils literal"><span class="pre">spintext()</span></code></a>, <code class="xref f f-func docutils literal"><span class="pre">surfstat2()</span></code>, <a class="reference internal" href="#f/_/surfstat" title="f/_/surfstat"><code class="xref f f-func docutils literal"><span class="pre">surfstat()</span></code></a>, <a class="reference internal" href="#f/_/fermiarc_jdos" title="f/_/fermiarc_jdos"><code class="xref f f-func docutils literal"><span class="pre">fermiarc_jdos()</span></code></a></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/_/inv" title="f/_/inv"><code class="xref f f-func docutils literal"><span class="pre">inv()</span></code></a>, <a class="reference internal" href="#f/_/mat_mul" title="f/_/mat_mul"><code class="xref f f-func docutils literal"><span class="pre">mat_mul()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/surfgreen_1984">
<em class="property">subroutine  </em><code class="descname">surfgreen_1984</code><span class="sig-paren">(</span><em>omega</em>, <em>gll</em>, <em>grr</em>, <em>h00</em>, <em>h01</em>, <em>ones</em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/surfgreen_1984" title="Permalink to this definition">¶</a></dt>
<dd><p>surfgreen_1984 calculates surface state using
Green&#8217;s function method  &#8212;  J.Phys.F.Met.Phys.14(1984)1205-1215
Quick iterative scheme for the calculation of transfer matrices:
application to Mo (100)</p>
<p>History:</p>
<blockquote>
<div><p>by Quan Sheng Wu on 4/20/2010</p>
<blockquote>
<div><p>mpi version      4/21/2010</p>
<p>little change to cpu version in Zurich Swiss Jan 25 2015</p>
</div></blockquote>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>omega</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>gll</strong> (<a class="reference internal" href="#f/para/ndim" title="f/para/ndim">ndim</a>,<a class="reference internal" href="#f/para/ndim" title="f/para/ndim">ndim</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>grr</strong> (<a class="reference internal" href="#f/para/ndim" title="f/para/ndim">ndim</a>,<a class="reference internal" href="#f/para/ndim" title="f/para/ndim">ndim</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>h00</strong> (<a class="reference internal" href="#f/para/ndim" title="f/para/ndim">ndim</a>,<a class="reference internal" href="#f/para/ndim" title="f/para/ndim">ndim</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>h01</strong> (<a class="reference internal" href="#f/para/ndim" title="f/para/ndim">ndim</a>,<a class="reference internal" href="#f/para/ndim" title="f/para/ndim">ndim</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>ones</strong> (<a class="reference internal" href="#f/para/ndim" title="f/para/ndim">ndim</a>,<a class="reference internal" href="#f/para/ndim" title="f/para/ndim">ndim</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Use :</th><td class="field-body"><p class="first"><code class="xref f f-mod docutils literal"><span class="pre">wmpi</span></code>, <a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/_/inv" title="f/_/inv"><code class="xref f f-func docutils literal"><span class="pre">inv()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="surfstat">
<h2>surfstat<a class="headerlink" href="#surfstat" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/_/surfstat">
<em class="property">subroutine  </em><code class="descname">surfstat</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/surfstat" title="Permalink to this definition">¶</a></dt>
<dd><p>surfstat calculates surface state using             !
green&#8217;s function method  &#8212;  J.Phys.F.Met.Phys.15(1985)851-858      !</p>
<p>History:</p>
<blockquote>
<div><p>by Quan Sheng Wu on 4/20/2010                                !</p>
<blockquote>
<div><p>mpi version      4/21/2010</p>
<p>Quansheng Wu on Jan 30 2015 at ETH Zurich</p>
</div></blockquote>
</div></blockquote>
<p>Copyright (c) 2010 QuanSheng Wu. All rights reserved.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Use :</th><td class="field-body"><code class="xref f f-mod docutils literal"><span class="pre">wmpi</span></code>, <a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><a class="reference internal" href="#f/main" title="f/main"><code class="xref f f-prog docutils literal"><span class="pre">main</span></code></a></td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><a class="reference internal" href="#f/_/ham_qlayer2qlayer" title="f/_/ham_qlayer2qlayer"><code class="xref f f-func docutils literal"><span class="pre">ham_qlayer2qlayer()</span></code></a>, <a class="reference internal" href="#f/_/surfgreen_1985" title="f/_/surfgreen_1985"><code class="xref f f-func docutils literal"><span class="pre">surfgreen_1985()</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="symmetry">
<h2>symmetry<a class="headerlink" href="#symmetry" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/_/symmetry">
<em class="property">subroutine  </em><code class="descname">symmetry</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/symmetry" title="Permalink to this definition">¶</a></dt>
<dd><p>Set symmetry, not finished yet.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Use :</th><td class="field-body"><a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="wanniercenter">
<h2>wanniercenter<a class="headerlink" href="#wanniercenter" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/_/wannier_center2d">
<em class="property">subroutine  </em><code class="descname">wannier_center2d</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/wannier_center2d" title="Permalink to this definition">¶</a></dt>
<dd><p>This suboutine is used for wannier center calculation for slab system</p>
<p>Copyright (c) 2010 QuanSheng Wu. All rights reserved.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Use :</th><td class="field-body"><code class="xref f f-mod docutils literal"><span class="pre">wmpi</span></code>, <a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Call to:</th><td class="field-body"><a class="reference internal" href="#f/_/ham_slab" title="f/_/ham_slab"><code class="xref f f-func docutils literal"><span class="pre">ham_slab()</span></code></a>, <a class="reference internal" href="#f/_/eigensystem_c" title="f/_/eigensystem_c"><code class="xref f f-func docutils literal"><span class="pre">eigensystem_c()</span></code></a>, <a class="reference internal" href="#f/_/mat_mul" title="f/_/mat_mul"><code class="xref f f-func docutils literal"><span class="pre">mat_mul()</span></code></a>, <a class="reference internal" href="#f/_/zgesvd_pack" title="f/_/zgesvd_pack"><code class="xref f f-func docutils literal"><span class="pre">zgesvd_pack()</span></code></a>, <a class="reference internal" href="#f/_/zgeev_pack" title="f/_/zgeev_pack"><code class="xref f f-func docutils literal"><span class="pre">zgeev_pack()</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/wannier_center2d_alt">
<em class="property">subroutine  </em><code class="descname">wannier_center2d_alt</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/wannier_center2d_alt" title="Permalink to this definition">¶</a></dt>
<dd><p>This suboutine is used for wannier center calculation for slab system
calculate z2</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Use :</th><td class="field-body"><code class="xref f f-mod docutils literal"><span class="pre">wmpi</span></code>, <a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Call to:</th><td class="field-body"><a class="reference internal" href="#f/_/inv_r" title="f/_/inv_r"><code class="xref f f-func docutils literal"><span class="pre">inv_r()</span></code></a>, <a class="reference internal" href="#f/_/ham_slab" title="f/_/ham_slab"><code class="xref f f-func docutils literal"><span class="pre">ham_slab()</span></code></a>, <a class="reference internal" href="#f/_/eigensystem_c" title="f/_/eigensystem_c"><code class="xref f f-func docutils literal"><span class="pre">eigensystem_c()</span></code></a>, <a class="reference internal" href="#f/_/zgesvd_pack" title="f/_/zgesvd_pack"><code class="xref f f-func docutils literal"><span class="pre">zgesvd_pack()</span></code></a>, <a class="reference internal" href="#f/_/mat_mul" title="f/_/mat_mul"><code class="xref f f-func docutils literal"><span class="pre">mat_mul()</span></code></a>, <a class="reference internal" href="#f/_/zgeev_pack" title="f/_/zgeev_pack"><code class="xref f f-func docutils literal"><span class="pre">zgeev_pack()</span></code></a>, <a class="reference internal" href="#f/_/sortheap" title="f/_/sortheap"><code class="xref f f-func docutils literal"><span class="pre">sortheap()</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/wannier_center3d_plane_mirror_minus">
<em class="property">subroutine  </em><code class="descname">wannier_center3d_plane_mirror_minus</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/wannier_center3d_plane_mirror_minus" title="Permalink to this definition">¶</a></dt>
<dd><p>&gt; this suboutine is used for wannier center calculation for 3D system
&gt; only for one plane, calculate mirror chern number. only choose the bands
&gt; which have the same mirror eigenvalue</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Use :</th><td class="field-body"><code class="xref f f-mod docutils literal"><span class="pre">wmpi</span></code>, <a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Call to:</th><td class="field-body"><a class="reference internal" href="#f/_/inv_r" title="f/_/inv_r"><code class="xref f f-func docutils literal"><span class="pre">inv_r()</span></code></a>, <a class="reference internal" href="#f/_/ham_bulk_old" title="f/_/ham_bulk_old"><code class="xref f f-func docutils literal"><span class="pre">ham_bulk_old()</span></code></a>, <a class="reference internal" href="#f/_/mat_mul" title="f/_/mat_mul"><code class="xref f f-func docutils literal"><span class="pre">mat_mul()</span></code></a>, <a class="reference internal" href="#f/_/eigensystem_c" title="f/_/eigensystem_c"><code class="xref f f-func docutils literal"><span class="pre">eigensystem_c()</span></code></a>, <a class="reference internal" href="#f/_/zgesvd_pack" title="f/_/zgesvd_pack"><code class="xref f f-func docutils literal"><span class="pre">zgesvd_pack()</span></code></a>, <a class="reference internal" href="#f/_/zgeev_pack" title="f/_/zgeev_pack"><code class="xref f f-func docutils literal"><span class="pre">zgeev_pack()</span></code></a>, <a class="reference internal" href="#f/_/sortheap" title="f/_/sortheap"><code class="xref f f-func docutils literal"><span class="pre">sortheap()</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/wannier_center3d_plane_mirror_plus">
<em class="property">subroutine  </em><code class="descname">wannier_center3d_plane_mirror_plus</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/wannier_center3d_plane_mirror_plus" title="Permalink to this definition">¶</a></dt>
<dd><p>&gt; this suboutine is used for wannier center calculation for 3D system
&gt; only for one plane, calculate mirror chern number. only choose the bands
&gt; which have the same mirror eigenvalue</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Use :</th><td class="field-body"><code class="xref f f-mod docutils literal"><span class="pre">wmpi</span></code>, <a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Call to:</th><td class="field-body"><a class="reference internal" href="#f/_/inv_r" title="f/_/inv_r"><code class="xref f f-func docutils literal"><span class="pre">inv_r()</span></code></a>, <a class="reference internal" href="#f/_/ham_bulk_old" title="f/_/ham_bulk_old"><code class="xref f f-func docutils literal"><span class="pre">ham_bulk_old()</span></code></a>, <a class="reference internal" href="#f/_/mat_mul" title="f/_/mat_mul"><code class="xref f f-func docutils literal"><span class="pre">mat_mul()</span></code></a>, <a class="reference internal" href="#f/_/eigensystem_c" title="f/_/eigensystem_c"><code class="xref f f-func docutils literal"><span class="pre">eigensystem_c()</span></code></a>, <a class="reference internal" href="#f/_/zgesvd_pack" title="f/_/zgesvd_pack"><code class="xref f f-func docutils literal"><span class="pre">zgesvd_pack()</span></code></a>, <a class="reference internal" href="#f/_/zgeev_pack" title="f/_/zgeev_pack"><code class="xref f f-func docutils literal"><span class="pre">zgeev_pack()</span></code></a>, <a class="reference internal" href="#f/_/sortheap" title="f/_/sortheap"><code class="xref f f-func docutils literal"><span class="pre">sortheap()</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/wannier_center3d_plane">
<em class="property">subroutine  </em><code class="descname">wannier_center3d_plane</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/wannier_center3d_plane" title="Permalink to this definition">¶</a></dt>
<dd><p>&gt; this suboutine is used for wannier center calculation for 3D system
&gt; only for one plane</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Use :</th><td class="field-body"><code class="xref f f-mod docutils literal"><span class="pre">wmpi</span></code>, <a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><a class="reference internal" href="#f/main" title="f/main"><code class="xref f f-prog docutils literal"><span class="pre">main</span></code></a></td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><a class="reference internal" href="#f/_/inv_r" title="f/_/inv_r"><code class="xref f f-func docutils literal"><span class="pre">inv_r()</span></code></a>, <a class="reference internal" href="#f/_/ham_bulk_old" title="f/_/ham_bulk_old"><code class="xref f f-func docutils literal"><span class="pre">ham_bulk_old()</span></code></a>, <a class="reference internal" href="#f/_/eigensystem_c" title="f/_/eigensystem_c"><code class="xref f f-func docutils literal"><span class="pre">eigensystem_c()</span></code></a>, <a class="reference internal" href="#f/_/zgesvd_pack" title="f/_/zgesvd_pack"><code class="xref f f-func docutils literal"><span class="pre">zgesvd_pack()</span></code></a>, <a class="reference internal" href="#f/_/mat_mul" title="f/_/mat_mul"><code class="xref f f-func docutils literal"><span class="pre">mat_mul()</span></code></a>, <a class="reference internal" href="#f/_/zgeev_pack" title="f/_/zgeev_pack"><code class="xref f f-func docutils literal"><span class="pre">zgeev_pack()</span></code></a>, <a class="reference internal" href="#f/_/sortheap" title="f/_/sortheap"><code class="xref f f-func docutils literal"><span class="pre">sortheap()</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/wannier_center3d">
<em class="property">subroutine  </em><code class="descname">wannier_center3d</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/wannier_center3d" title="Permalink to this definition">¶</a></dt>
<dd><p>this suboutine is used for wannier center calculation for 3D system</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Use :</th><td class="field-body"><code class="xref f f-mod docutils literal"><span class="pre">wmpi</span></code>, <a class="reference internal" href="#f/para" title="f/para: &gt; Some global parameters"><code class="xref f f-mod docutils literal"><span class="pre">para</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Call to:</th><td class="field-body"><a class="reference internal" href="#f/_/inv_r" title="f/_/inv_r"><code class="xref f f-func docutils literal"><span class="pre">inv_r()</span></code></a>, <a class="reference internal" href="#f/_/ham_bulk_old" title="f/_/ham_bulk_old"><code class="xref f f-func docutils literal"><span class="pre">ham_bulk_old()</span></code></a>, <a class="reference internal" href="#f/_/eigensystem_c" title="f/_/eigensystem_c"><code class="xref f f-func docutils literal"><span class="pre">eigensystem_c()</span></code></a>, <a class="reference internal" href="#f/_/zgesvd_pack" title="f/_/zgesvd_pack"><code class="xref f f-func docutils literal"><span class="pre">zgesvd_pack()</span></code></a>, <a class="reference internal" href="#f/_/mat_mul" title="f/_/mat_mul"><code class="xref f f-func docutils literal"><span class="pre">mat_mul()</span></code></a>, <a class="reference internal" href="#f/_/zgeev_pack" title="f/_/zgeev_pack"><code class="xref f f-func docutils literal"><span class="pre">zgeev_pack()</span></code></a>, <a class="reference internal" href="#f/_/sortheap" title="f/_/sortheap"><code class="xref f f-func docutils literal"><span class="pre">sortheap()</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/sortheap">
<em class="property">subroutine  </em><code class="descname">sortheap</code><span class="sig-paren">(</span><em>n</em>, <em>arr</em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/sortheap" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>n</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em></li>
<li><strong>arr</strong> (n)<em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/_/swap" title="f/_/swap"><code class="xref f f-func docutils literal"><span class="pre">swap()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/swap">
<em class="property">subroutine  </em><code class="descname">swap</code><span class="sig-paren">(</span><em>a</em>, <em>b</em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/swap" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>a</strong><em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></li>
<li><strong>b</strong><em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="f/para">
<span id="module-para"></span><h2>Module para<a class="headerlink" href="#f/para" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Description</p>
<p>&gt; Some global parameters</p>
<p>&gt; Copyright (c) 2010 QuanSheng Wu. All rights reserved.</p>
<p>&gt; add namelist for convenience  June 5th 2016 by QuanSheng Wu</p>
<p class="rubric">Quick access</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><a class="reference internal" href="#f/para/max_projs" title="f/para/max_projs"><code class="xref f f-var docutils literal"><span class="pre">max_projs</span></code></a>, <a class="reference internal" href="#f/para/nbottomorbitals" title="f/para/nbottomorbitals"><code class="xref f f-var docutils literal"><span class="pre">nbottomorbitals</span></code></a>, <a class="reference internal" href="#f/para/ntoporbitals" title="f/para/ntoporbitals"><code class="xref f f-var docutils literal"><span class="pre">ntoporbitals</span></code></a>, <a class="reference internal" href="#f/para/ndim" title="f/para/ndim"><code class="xref f f-var docutils literal"><span class="pre">ndim</span></code></a>, <a class="reference internal" href="#f/para/ntotch" title="f/para/ntotch"><code class="xref f f-var docutils literal"><span class="pre">ntotch</span></code></a>, <a class="reference internal" href="#f/para/numoccupied" title="f/para/numoccupied"><code class="xref f f-var docutils literal"><span class="pre">numoccupied</span></code></a>, <a class="reference internal" href="#f/para/np" title="f/para/np"><code class="xref f f-var docutils literal"><span class="pre">np</span></code></a>, <a class="reference internal" href="#f/para/soc" title="f/para/soc"><code class="xref f f-var docutils literal"><span class="pre">soc</span></code></a>, <a class="reference internal" href="#f/para/cpuid" title="f/para/cpuid"><code class="xref f f-var docutils literal"><span class="pre">cpuid</span></code></a>, <a class="reference internal" href="#f/para/wireband_calc" title="f/para/wireband_calc"><code class="xref f f-var docutils literal"><span class="pre">wireband_calc</span></code></a>, <a class="reference internal" href="#f/para/slabband_calc" title="f/para/slabband_calc"><code class="xref f f-var docutils literal"><span class="pre">slabband_calc</span></code></a>, <a class="reference internal" href="#f/para/berrycurvature_calc" title="f/para/berrycurvature_calc"><code class="xref f f-var docutils literal"><span class="pre">berrycurvature_calc</span></code></a>, <a class="reference internal" href="#f/para/berryphase_calc" title="f/para/berryphase_calc"><code class="xref f f-var docutils literal"><span class="pre">berryphase_calc</span></code></a>, <a class="reference internal" href="#f/para/bulkgap_cube_calc" title="f/para/bulkgap_cube_calc"><code class="xref f f-var docutils literal"><span class="pre">bulkgap_cube_calc</span></code></a>, <a class="reference internal" href="#f/para/bulkgap_plane_calc" title="f/para/bulkgap_plane_calc"><code class="xref f f-var docutils literal"><span class="pre">bulkgap_plane_calc</span></code></a>, <a class="reference internal" href="#f/para/wanniercenter_calc" title="f/para/wanniercenter_calc"><code class="xref f f-var docutils literal"><span class="pre">wanniercenter_calc</span></code></a>, <a class="reference internal" href="#f/para/bulkfs_calc" title="f/para/bulkfs_calc"><code class="xref f f-var docutils literal"><span class="pre">bulkfs_calc</span></code></a>, <a class="reference internal" href="#f/para/bulkband_calc" title="f/para/bulkband_calc"><code class="xref f f-var docutils literal"><span class="pre">bulkband_calc</span></code></a>, <a class="reference internal" href="#f/para/bulkfs_plane_calc" title="f/para/bulkfs_plane_calc"><code class="xref f f-var docutils literal"><span class="pre">bulkfs_plane_calc</span></code></a>, <a class="reference internal" href="#f/para/dos_calc" title="f/para/dos_calc"><code class="xref f f-var docutils literal"><span class="pre">dos_calc</span></code></a>, <a class="reference internal" href="#f/para/effectivemass_calc" title="f/para/effectivemass_calc"><code class="xref f f-var docutils literal"><span class="pre">effectivemass_calc</span></code></a>, <a class="reference internal" href="#f/para/jdos_calc" title="f/para/jdos_calc"><code class="xref f f-var docutils literal"><span class="pre">jdos_calc</span></code></a>, <a class="reference internal" href="#f/para/slabss_calc" title="f/para/slabss_calc"><code class="xref f f-var docutils literal"><span class="pre">slabss_calc</span></code></a>, <a class="reference internal" href="#f/para/slabqpi_calc" title="f/para/slabqpi_calc"><code class="xref f f-var docutils literal"><span class="pre">slabqpi_calc</span></code></a>, <a class="reference internal" href="#f/para/slabarc_calc" title="f/para/slabarc_calc"><code class="xref f f-var docutils literal"><span class="pre">slabarc_calc</span></code></a>, <a class="reference internal" href="#f/para/slabspintexture_calc" title="f/para/slabspintexture_calc"><code class="xref f f-var docutils literal"><span class="pre">slabspintexture_calc</span></code></a>, <a class="reference internal" href="#f/para/nk3lines" title="f/para/nk3lines"><code class="xref f f-var docutils literal"><span class="pre">nk3lines</span></code></a>, <a class="reference internal" href="#f/para/nk3_band" title="f/para/nk3_band"><code class="xref f f-var docutils literal"><span class="pre">nk3_band</span></code></a>, <a class="reference internal" href="#f/para/nrpts" title="f/para/nrpts"><code class="xref f f-var docutils literal"><span class="pre">nrpts</span></code></a>, <a class="reference internal" href="#f/para/num_wann" title="f/para/num_wann"><code class="xref f f-var docutils literal"><span class="pre">num_wann</span></code></a>, <a class="reference internal" href="#f/para/nk2lines" title="f/para/nk2lines"><code class="xref f f-var docutils literal"><span class="pre">nk2lines</span></code></a>, <a class="reference internal" href="#f/para/knv2" title="f/para/knv2"><code class="xref f f-var docutils literal"><span class="pre">knv2</span></code></a>, <a class="reference internal" href="#f/para/num_cpu" title="f/para/num_cpu"><code class="xref f f-var docutils literal"><span class="pre">num_cpu</span></code></a>, <a class="reference internal" href="#f/para/nslab1" title="f/para/nslab1"><code class="xref f f-var docutils literal"><span class="pre">nslab1</span></code></a>, <a class="reference internal" href="#f/para/nslab2" title="f/para/nslab2"><code class="xref f f-var docutils literal"><span class="pre">nslab2</span></code></a>, <a class="reference internal" href="#f/para/nslab" title="f/para/nslab"><code class="xref f f-var docutils literal"><span class="pre">nslab</span></code></a>, <a class="reference internal" href="#f/para/nbottomatoms" title="f/para/nbottomatoms"><code class="xref f f-var docutils literal"><span class="pre">nbottomatoms</span></code></a>, <a class="reference internal" href="#f/para/ntopatoms" title="f/para/ntopatoms"><code class="xref f f-var docutils literal"><span class="pre">ntopatoms</span></code></a>, <a class="reference internal" href="#f/para/omeganum" title="f/para/omeganum"><code class="xref f f-var docutils literal"><span class="pre">omeganum</span></code></a>, <a class="reference internal" href="#f/para/num_atoms" title="f/para/num_atoms"><code class="xref f f-var docutils literal"><span class="pre">num_atoms</span></code></a>, <a class="reference internal" href="#f/para/nk" title="f/para/nk"><code class="xref f f-var docutils literal"><span class="pre">nk</span></code></a>, <a class="reference internal" href="#f/para/nk1" title="f/para/nk1"><code class="xref f f-var docutils literal"><span class="pre">nk1</span></code></a>, <a class="reference internal" href="#f/para/nk2" title="f/para/nk2"><code class="xref f f-var docutils literal"><span class="pre">nk2</span></code></a>, <a class="reference internal" href="#f/para/nk3" title="f/para/nk3"><code class="xref f f-var docutils literal"><span class="pre">nk3</span></code></a>, <a class="reference internal" href="#f/para/iband_mass" title="f/para/iband_mass"><code class="xref f f-var docutils literal"><span class="pre">iband_mass</span></code></a>, <a class="reference internal" href="#f/para/angorbohr" title="f/para/angorbohr"><code class="xref f f-var docutils literal"><span class="pre">angorbohr</span></code></a>, <a class="reference internal" href="#f/para/directorcart" title="f/para/directorcart"><code class="xref f f-var docutils literal"><span class="pre">directorcart</span></code></a>, <a class="reference internal" href="#f/para/hrfile" title="f/para/hrfile"><code class="xref f f-var docutils literal"><span class="pre">hrfile</span></code></a>, <a class="reference internal" href="#f/para/by" title="f/para/by"><code class="xref f f-var docutils literal"><span class="pre">by</span></code></a>, <a class="reference internal" href="#f/para/bz" title="f/para/bz"><code class="xref f f-var docutils literal"><span class="pre">bz</span></code></a>, <a class="reference internal" href="#f/para/kcubevolume" title="f/para/kcubevolume"><code class="xref f f-var docutils literal"><span class="pre">kcubevolume</span></code></a>, <a class="reference internal" href="#f/para/omegamax" title="f/para/omegamax"><code class="xref f f-var docutils literal"><span class="pre">omegamax</span></code></a>, <a class="reference internal" href="#f/para/primitivecellvolume" title="f/para/primitivecellvolume"><code class="xref f f-var docutils literal"><span class="pre">primitivecellvolume</span></code></a>, <a class="reference internal" href="#f/para/bx" title="f/para/bx"><code class="xref f f-var docutils literal"><span class="pre">bx</span></code></a>, <a class="reference internal" href="#f/para/surf_onsite" title="f/para/surf_onsite"><code class="xref f f-var docutils literal"><span class="pre">surf_onsite</span></code></a>, <a class="reference internal" href="#f/para/cellvolume" title="f/para/cellvolume"><code class="xref f f-var docutils literal"><span class="pre">cellvolume</span></code></a>, <a class="reference internal" href="#f/para/e_arc" title="f/para/e_arc"><code class="xref f f-var docutils literal"><span class="pre">e_arc</span></code></a>, <a class="reference internal" href="#f/para/e_fermi" title="f/para/e_fermi"><code class="xref f f-var docutils literal"><span class="pre">e_fermi</span></code></a>, <a class="reference internal" href="#f/para/omegamin" title="f/para/omegamin"><code class="xref f f-var docutils literal"><span class="pre">omegamin</span></code></a>, <a class="reference internal" href="#f/para/gap_threshold" title="f/para/gap_threshold"><code class="xref f f-var docutils literal"><span class="pre">gap_threshold</span></code></a>, <a class="reference internal" href="#f/para/eta" title="f/para/eta"><code class="xref f f-var docutils literal"><span class="pre">eta</span></code></a>, <a class="reference internal" href="#f/para/eta_arc" title="f/para/eta_arc"><code class="xref f f-var docutils literal"><span class="pre">eta_arc</span></code></a>, <a class="reference internal" href="#f/para/outfileindex" title="f/para/outfileindex"><code class="xref f f-var docutils literal"><span class="pre">outfileindex</span></code></a>, <a class="reference internal" href="#f/para/nr3" title="f/para/nr3"><code class="xref f f-var docutils literal"><span class="pre">nr3</span></code></a>, <a class="reference internal" href="#f/para/nr1" title="f/para/nr1"><code class="xref f f-var docutils literal"><span class="pre">nr1</span></code></a>, <a class="reference internal" href="#f/para/nr2" title="f/para/nr2"><code class="xref f f-var docutils literal"><span class="pre">nr2</span></code></a>, <a class="reference internal" href="#f/para/ijmax" title="f/para/ijmax"><code class="xref f f-var docutils literal"><span class="pre">ijmax</span></code></a>, <a class="reference internal" href="#f/para/stdout_bn" title="f/para/stdout_bn"><code class="xref f f-var docutils literal"><span class="pre">stdout_bn</span></code></a>, <a class="reference internal" href="#f/para/dp" title="f/para/dp"><code class="xref f f-var docutils literal"><span class="pre">dp</span></code></a>, <a class="reference internal" href="#f/para/mpi_cmw" title="f/para/mpi_cmw"><code class="xref f f-var docutils literal"><span class="pre">mpi_cmw</span></code></a>, <a class="reference internal" href="#f/para/mpi_dc" title="f/para/mpi_dc"><code class="xref f f-var docutils literal"><span class="pre">mpi_dc</span></code></a>, <a class="reference internal" href="#f/para/mpi_dp" title="f/para/mpi_dp"><code class="xref f f-var docutils literal"><span class="pre">mpi_dp</span></code></a>, <a class="reference internal" href="#f/para/mpi_in" title="f/para/mpi_in"><code class="xref f f-var docutils literal"><span class="pre">mpi_in</span></code></a>, <a class="reference internal" href="#f/para/bottomatoms" title="f/para/bottomatoms"><code class="xref f f-var docutils literal"><span class="pre">bottomatoms</span></code></a>, <a class="reference internal" href="#f/para/bottomorbitals" title="f/para/bottomorbitals"><code class="xref f f-var docutils literal"><span class="pre">bottomorbitals</span></code></a>, <a class="reference internal" href="#f/para/ndegen" title="f/para/ndegen"><code class="xref f f-var docutils literal"><span class="pre">ndegen</span></code></a>, <a class="reference internal" href="#f/para/nprojs" title="f/para/nprojs"><code class="xref f f-var docutils literal"><span class="pre">nprojs</span></code></a>, <a class="reference internal" href="#f/para/orbitals_start" title="f/para/orbitals_start"><code class="xref f f-var docutils literal"><span class="pre">orbitals_start</span></code></a>, <a class="reference internal" href="#f/para/topatoms" title="f/para/topatoms"><code class="xref f f-var docutils literal"><span class="pre">topatoms</span></code></a>, <a class="reference internal" href="#f/para/toporbitals" title="f/para/toporbitals"><code class="xref f f-var docutils literal"><span class="pre">toporbitals</span></code></a>, <a class="reference internal" href="#f/para/irvec" title="f/para/irvec"><code class="xref f f-var docutils literal"><span class="pre">irvec</span></code></a>, <a class="reference internal" href="#f/para/dk_mass" title="f/para/dk_mass"><code class="xref f f-var docutils literal"><span class="pre">dk_mass</span></code></a>, <a class="reference internal" href="#f/para/kmesh" title="f/para/kmesh"><code class="xref f f-var docutils literal"><span class="pre">kmesh</span></code></a>, <a class="reference internal" href="#f/para/zi" title="f/para/zi"><code class="xref f f-var docutils literal"><span class="pre">zi</span></code></a>, <a class="reference internal" href="#f/para/pi2zi" title="f/para/pi2zi"><code class="xref f f-var docutils literal"><span class="pre">pi2zi</span></code></a>, <a class="reference internal" href="#f/para/eps3" title="f/para/eps3"><code class="xref f f-var docutils literal"><span class="pre">eps3</span></code></a>, <a class="reference internal" href="#f/para/zero" title="f/para/zero"><code class="xref f f-var docutils literal"><span class="pre">zero</span></code></a>, <a class="reference internal" href="#f/para/bohr2atomic" title="f/para/bohr2atomic"><code class="xref f f-var docutils literal"><span class="pre">bohr2atomic</span></code></a>, <a class="reference internal" href="#f/para/half" title="f/para/half"><code class="xref f f-var docutils literal"><span class="pre">half</span></code></a>, <a class="reference internal" href="#f/para/one" title="f/para/one"><code class="xref f f-var docutils literal"><span class="pre">one</span></code></a>, <a class="reference internal" href="#f/para/alpha" title="f/para/alpha"><code class="xref f f-var docutils literal"><span class="pre">alpha</span></code></a>, <a class="reference internal" href="#f/para/ev2hartree" title="f/para/ev2hartree"><code class="xref f f-var docutils literal"><span class="pre">ev2hartree</span></code></a>, <a class="reference internal" href="#f/para/eps6" title="f/para/eps6"><code class="xref f f-var docutils literal"><span class="pre">eps6</span></code></a>, <a class="reference internal" href="#f/para/eps9" title="f/para/eps9"><code class="xref f f-var docutils literal"><span class="pre">eps9</span></code></a>, <a class="reference internal" href="#f/para/pi" title="f/para/pi"><code class="xref f f-var docutils literal"><span class="pre">pi</span></code></a>, <a class="reference internal" href="#f/para/knv" title="f/para/knv"><code class="xref f f-var docutils literal"><span class="pre">knv</span></code></a>, <a class="reference internal" href="#f/para/k2line_name" title="f/para/k2line_name"><code class="xref f f-var docutils literal"><span class="pre">k2line_name</span></code></a>, <a class="reference internal" href="#f/para/k3d_vec3" title="f/para/k3d_vec3"><code class="xref f f-var docutils literal"><span class="pre">k3d_vec3</span></code></a>, <a class="reference internal" href="#f/para/k2line_stop" title="f/para/k2line_stop"><code class="xref f f-var docutils literal"><span class="pre">k2line_stop</span></code></a>, <a class="reference internal" href="#f/para/ke" title="f/para/ke"><code class="xref f f-var docutils literal"><span class="pre">ke</span></code></a>, <a class="reference internal" href="#f/para/k2d_start" title="f/para/k2d_start"><code class="xref f f-var docutils literal"><span class="pre">k2d_start</span></code></a>, <a class="reference internal" href="#f/para/kp" title="f/para/kp"><code class="xref f f-var docutils literal"><span class="pre">kp</span></code></a>, <a class="reference internal" href="#f/para/k3d_vec1" title="f/para/k3d_vec1"><code class="xref f f-var docutils literal"><span class="pre">k3d_vec1</span></code></a>, <a class="reference internal" href="#f/para/k3d_vec1_cube" title="f/para/k3d_vec1_cube"><code class="xref f f-var docutils literal"><span class="pre">k3d_vec1_cube</span></code></a>, <a class="reference internal" href="#f/para/k2d_vec1" title="f/para/k2d_vec1"><code class="xref f f-var docutils literal"><span class="pre">k2d_vec1</span></code></a>, <a class="reference internal" href="#f/para/k3d_vec2" title="f/para/k3d_vec2"><code class="xref f f-var docutils literal"><span class="pre">k3d_vec2</span></code></a>, <a class="reference internal" href="#f/para/k3d_vec2_cube" title="f/para/k3d_vec2_cube"><code class="xref f f-var docutils literal"><span class="pre">k3d_vec2_cube</span></code></a>, <a class="reference internal" href="#f/para/k2d_vec2" title="f/para/k2d_vec2"><code class="xref f f-var docutils literal"><span class="pre">k2d_vec2</span></code></a>, <a class="reference internal" href="#f/para/k3d_vec3_cube" title="f/para/k3d_vec3_cube"><code class="xref f f-var docutils literal"><span class="pre">k3d_vec3_cube</span></code></a>, <a class="reference internal" href="#f/para/k3d_start" title="f/para/k3d_start"><code class="xref f f-var docutils literal"><span class="pre">k3d_start</span></code></a>, <a class="reference internal" href="#f/para/k3d_start_cube" title="f/para/k3d_start_cube"><code class="xref f f-var docutils literal"><span class="pre">k3d_start_cube</span></code></a>, <a class="reference internal" href="#f/para/atom_name" title="f/para/atom_name"><code class="xref f f-var docutils literal"><span class="pre">atom_name</span></code></a>, <a class="reference internal" href="#f/para/proj_name" title="f/para/proj_name"><code class="xref f f-var docutils literal"><span class="pre">proj_name</span></code></a>, <a class="reference internal" href="#f/para/k3line_name" title="f/para/k3line_name"><code class="xref f f-var docutils literal"><span class="pre">k3line_name</span></code></a>, <a class="reference internal" href="#f/para/k2len" title="f/para/k2len"><code class="xref f f-var docutils literal"><span class="pre">k2len</span></code></a>, <a class="reference internal" href="#f/para/k3len" title="f/para/k3len"><code class="xref f f-var docutils literal"><span class="pre">k3len</span></code></a>, <a class="reference internal" href="#f/para/k3line_stop" title="f/para/k3line_stop"><code class="xref f f-var docutils literal"><span class="pre">k3line_stop</span></code></a>, <a class="reference internal" href="#f/para/atom_position" title="f/para/atom_position"><code class="xref f f-var docutils literal"><span class="pre">atom_position</span></code></a>, <a class="reference internal" href="#f/para/atom_position_direct" title="f/para/atom_position_direct"><code class="xref f f-var docutils literal"><span class="pre">atom_position_direct</span></code></a>, <a class="reference internal" href="#f/para/glide" title="f/para/glide"><code class="xref f f-var docutils literal"><span class="pre">glide</span></code></a>, <a class="reference internal" href="#f/para/glide_y_op" title="f/para/glide_y_op"><code class="xref f f-var docutils literal"><span class="pre">glide_y_op</span></code></a>, <a class="reference internal" href="#f/para/inv_op" title="f/para/inv_op"><code class="xref f f-var docutils literal"><span class="pre">inv_op</span></code></a>, <a class="reference internal" href="#f/para/inversion" title="f/para/inversion"><code class="xref f f-var docutils literal"><span class="pre">inversion</span></code></a>, <a class="reference internal" href="#f/para/k2_path" title="f/para/k2_path"><code class="xref f f-var docutils literal"><span class="pre">k2_path</span></code></a>, <a class="reference internal" href="#f/para/k3line_end" title="f/para/k3line_end"><code class="xref f f-var docutils literal"><span class="pre">k3line_end</span></code></a>, <a class="reference internal" href="#f/para/k3line_start" title="f/para/k3line_start"><code class="xref f f-var docutils literal"><span class="pre">k3line_start</span></code></a>, <a class="reference internal" href="#f/para/k3list_band" title="f/para/k3list_band"><code class="xref f f-var docutils literal"><span class="pre">k3list_band</span></code></a>, <a class="reference internal" href="#f/para/k3points" title="f/para/k3points"><code class="xref f f-var docutils literal"><span class="pre">k3points</span></code></a>, <a class="reference internal" href="#f/para/mirror_x" title="f/para/mirror_x"><code class="xref f f-var docutils literal"><span class="pre">mirror_x</span></code></a>, <a class="reference internal" href="#f/para/mirror_x_op" title="f/para/mirror_x_op"><code class="xref f f-var docutils literal"><span class="pre">mirror_x_op</span></code></a>, <a class="reference internal" href="#f/para/mirror_y_op" title="f/para/mirror_y_op"><code class="xref f f-var docutils literal"><span class="pre">mirror_y_op</span></code></a>, <a class="reference internal" href="#f/para/mirror_z" title="f/para/mirror_z"><code class="xref f f-var docutils literal"><span class="pre">mirror_z</span></code></a>, <a class="reference internal" href="#f/para/mirror_z_op" title="f/para/mirror_z_op"><code class="xref f f-var docutils literal"><span class="pre">mirror_z_op</span></code></a>, <a class="reference internal" href="#f/para/wannier_centers_cart" title="f/para/wannier_centers_cart"><code class="xref f f-var docutils literal"><span class="pre">wannier_centers_cart</span></code></a>, <a class="reference internal" href="#f/para/wannier_centers_direct" title="f/para/wannier_centers_direct"><code class="xref f f-var docutils literal"><span class="pre">wannier_centers_direct</span></code></a>, <a class="reference internal" href="#f/para/hmnr" title="f/para/hmnr"><code class="xref f f-var docutils literal"><span class="pre">hmnr</span></code></a>, <a class="reference internal" href="#f/para/ka2" title="f/para/ka2"><code class="xref f f-var docutils literal"><span class="pre">ka2</span></code></a>, <a class="reference internal" href="#f/para/kb2" title="f/para/kb2"><code class="xref f f-var docutils literal"><span class="pre">kb2</span></code></a>, <a class="reference internal" href="#f/para/ra2" title="f/para/ra2"><code class="xref f f-var docutils literal"><span class="pre">ra2</span></code></a>, <a class="reference internal" href="#f/para/rb2" title="f/para/rb2"><code class="xref f f-var docutils literal"><span class="pre">rb2</span></code></a>, <a class="reference internal" href="#f/para/rua_new" title="f/para/rua_new"><code class="xref f f-var docutils literal"><span class="pre">rua_new</span></code></a>, <a class="reference internal" href="#f/para/rub_new" title="f/para/rub_new"><code class="xref f f-var docutils literal"><span class="pre">rub_new</span></code></a>, <a class="reference internal" href="#f/para/ruc_new" title="f/para/ruc_new"><code class="xref f f-var docutils literal"><span class="pre">ruc_new</span></code></a>, <a class="reference internal" href="#f/para/urot" title="f/para/urot"><code class="xref f f-var docutils literal"><span class="pre">urot</span></code></a>, <a class="reference internal" href="#f/para/umatrix" title="f/para/umatrix"><code class="xref f f-var docutils literal"><span class="pre">umatrix</span></code></a>, <a class="reference internal" href="#f/para/k_mass" title="f/para/k_mass"><code class="xref f f-var docutils literal"><span class="pre">k_mass</span></code></a>, <a class="reference internal" href="#f/para/rua" title="f/para/rua"><code class="xref f f-var docutils literal"><span class="pre">rua</span></code></a>, <a class="reference internal" href="#f/para/rub" title="f/para/rub"><code class="xref f f-var docutils literal"><span class="pre">rub</span></code></a>, <a class="reference internal" href="#f/para/ruc" title="f/para/ruc"><code class="xref f f-var docutils literal"><span class="pre">ruc</span></code></a>, <a class="reference internal" href="#f/para/kua" title="f/para/kua"><code class="xref f f-var docutils literal"><span class="pre">kua</span></code></a>, <a class="reference internal" href="#f/para/kub" title="f/para/kub"><code class="xref f f-var docutils literal"><span class="pre">kub</span></code></a>, <a class="reference internal" href="#f/para/kuc" title="f/para/kuc"><code class="xref f f-var docutils literal"><span class="pre">kuc</span></code></a>, <a class="reference internal" href="#f/para/kb" title="f/para/kb"><code class="xref f f-var docutils literal"><span class="pre">kb</span></code></a>, <a class="reference internal" href="#f/para/ka" title="f/para/ka"><code class="xref f f-var docutils literal"><span class="pre">ka</span></code></a></td>
</tr>
</tbody>
</table>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><code class="xref f f-mod docutils literal"><span class="pre">wmpi</span></code></li>
</ul>
<p class="rubric">Variables</p>
<ul>
<li><dl class="variable">
<dt id="f/para/nrpts">
<code class="descclassname">para/</code><code class="descname">nrpts</code><em> [</em><em>integer</em><em>]</em><a class="headerlink" href="#f/para/nrpts" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of R points</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/k3list_band">
<code class="descclassname">para/</code><code class="descname">k3list_band</code> (*,*)<em> [</em><em>real</em><em>,</em><em>allocatable</em><em>]</em><a class="headerlink" href="#f/para/k3list_band" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/berryphase_calc">
<code class="descclassname">para/</code><code class="descname">berryphase_calc</code><em> [</em><em>logical</em><em>]</em><a class="headerlink" href="#f/para/berryphase_calc" title="Permalink to this definition">¶</a></dt>
<dd><p>Flag for Berry phase calculation</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/ijmax">
<code class="descclassname">para/</code><code class="descname">ijmax</code><em> [</em><em>integer</em><em>,</em><em>save/public</em><em>]</em><a class="headerlink" href="#f/para/ijmax" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/gap_threshold">
<code class="descclassname">para/</code><code class="descname">gap_threshold</code><em> [</em><em>real</em><em>]</em><a class="headerlink" href="#f/para/gap_threshold" title="Permalink to this definition">¶</a></dt>
<dd><p>threshold value for output the the k points data for Gap3D</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/nprojs">
<code class="descclassname">para/</code><code class="descname">nprojs</code> (*)<em> [</em><em>integer</em><em>,</em><em>allocatable</em><em>]</em><a class="headerlink" href="#f/para/nprojs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/iband_mass">
<code class="descclassname">para/</code><code class="descname">iband_mass</code><em> [</em><em>integer</em><em>,</em><em>save/public</em><em>]</em><a class="headerlink" href="#f/para/iband_mass" title="Permalink to this definition">¶</a></dt>
<dd><p>the i&#8217;th band for effective mass calculation</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/glide">
<code class="descclassname">para/</code><code class="descname">glide</code> (*,*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em><a class="headerlink" href="#f/para/glide" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/num_cpu">
<code class="descclassname">para/</code><code class="descname">num_cpu</code><em> [</em><em>integer</em><em>]</em><a class="headerlink" href="#f/para/num_cpu" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of processors for mpi</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/jdos_calc">
<code class="descclassname">para/</code><code class="descname">jdos_calc</code><em> [</em><em>logical</em><em>]</em><a class="headerlink" href="#f/para/jdos_calc" title="Permalink to this definition">¶</a></dt>
<dd><p>Flag for joint density of state calculation</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/k3line_end">
<code class="descclassname">para/</code><code class="descname">k3line_end</code> (*,*)<em> [</em><em>real</em><em>,</em><em>allocatable</em><em>]</em><a class="headerlink" href="#f/para/k3line_end" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/nbottomatoms">
<code class="descclassname">para/</code><code class="descname">nbottomatoms</code><em> [</em><em>integer</em><em>]</em><a class="headerlink" href="#f/para/nbottomatoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Select atoms on the bottom  surface for surface state output</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/mirror_y_op">
<code class="descclassname">para/</code><code class="descname">mirror_y_op</code> (*,*)<em> [</em><em>real</em><em>,</em><em>allocatable</em><em>]</em><a class="headerlink" href="#f/para/mirror_y_op" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/atom_position_direct">
<code class="descclassname">para/</code><code class="descname">atom_position_direct</code> (*,*)<em> [</em><em>real</em><em>,</em><em>allocatable</em><em>]</em><a class="headerlink" href="#f/para/atom_position_direct" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/hmnr">
<code class="descclassname">para/</code><code class="descname">hmnr</code> (*,*,*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em><a class="headerlink" href="#f/para/hmnr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/slabspintexture_calc">
<code class="descclassname">para/</code><code class="descname">slabspintexture_calc</code><em> [</em><em>logical</em><em>]</em><a class="headerlink" href="#f/para/slabspintexture_calc" title="Permalink to this definition">¶</a></dt>
<dd><p>Flag for surface state spin-texture calculation</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/k2_path">
<code class="descclassname">para/</code><code class="descname">k2_path</code> (*,*)<em> [</em><em>real</em><em>,</em><em>allocatable</em><em>]</em><a class="headerlink" href="#f/para/k2_path" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/nk2lines">
<code class="descclassname">para/</code><code class="descname">nk2lines</code><em> [</em><em>integer</em><em>]</em><a class="headerlink" href="#f/para/nk2lines" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of k lines for 2D slab band calculation</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/half">
<code class="descclassname">para/</code><code class="descname">half</code><em> [</em><em>real</em><em>,</em><em>parameter=</em>0.5d0<em>]</em><a class="headerlink" href="#f/para/half" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/kb2">
<code class="descclassname">para/</code><code class="descname">kb2</code> (2)<em> [</em><em>real</em><em>,</em><em>save/public</em><em>]</em><a class="headerlink" href="#f/para/kb2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/proj_name">
<code class="descclassname">para/</code><code class="descname">proj_name</code> (*,*)<em> [</em><em>character</em><em>,</em><em>allocatable</em><em>]</em><a class="headerlink" href="#f/para/proj_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/dp">
<code class="descclassname">para/</code><code class="descname">dp</code><em> [</em><em>integer</em><em>,</em><em>parameter=</em>kind(1.0d0)<em>]</em><a class="headerlink" href="#f/para/dp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/inversion">
<code class="descclassname">para/</code><code class="descname">inversion</code> (*,*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em><a class="headerlink" href="#f/para/inversion" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/rub_new">
<code class="descclassname">para/</code><code class="descname">rub_new</code> (3)<em> [</em><em>real</em><em>,</em><em>save/public</em><em>]</em><a class="headerlink" href="#f/para/rub_new" title="Permalink to this definition">¶</a></dt>
<dd><p>&gt; three primitive vectors in new coordinate system, see slab part</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/e_fermi">
<code class="descclassname">para/</code><code class="descname">e_fermi</code><em> [</em><em>real</em><em>]</em><a class="headerlink" href="#f/para/e_fermi" title="Permalink to this definition">¶</a></dt>
<dd><p>Fermi energy, search E-fermi in OUTCAR for VASP, set to zero for Wien2k</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/nbottomorbitals">
<code class="descclassname">para/</code><code class="descname">nbottomorbitals</code><em> [</em><em>integer</em><em>]</em><a class="headerlink" href="#f/para/nbottomorbitals" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/slabarc_calc">
<code class="descclassname">para/</code><code class="descname">slabarc_calc</code><em> [</em><em>logical</em><em>]</em><a class="headerlink" href="#f/para/slabarc_calc" title="Permalink to this definition">¶</a></dt>
<dd><p>Flag for surface state fermi-arc calculation</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/bulkgap_plane_calc">
<code class="descclassname">para/</code><code class="descname">bulkgap_plane_calc</code><em> [</em><em>logical</em><em>]</em><a class="headerlink" href="#f/para/bulkgap_plane_calc" title="Permalink to this definition">¶</a></dt>
<dd><p>Flag for Gap_plane calculation</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/k3d_vec3">
<code class="descclassname">para/</code><code class="descname">k3d_vec3</code> (3)<em> [</em><em>real</em><em>]</em><a class="headerlink" href="#f/para/k3d_vec3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/k3d_vec2">
<code class="descclassname">para/</code><code class="descname">k3d_vec2</code> (3)<em> [</em><em>real</em><em>]</em><a class="headerlink" href="#f/para/k3d_vec2" title="Permalink to this definition">¶</a></dt>
<dd><p>the 2nd k vector for the 3D k plane</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/k3d_vec1">
<code class="descclassname">para/</code><code class="descname">k3d_vec1</code> (3)<em> [</em><em>real</em><em>]</em><a class="headerlink" href="#f/para/k3d_vec1" title="Permalink to this definition">¶</a></dt>
<dd><p>the 1st k vector for the 3D k plane</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/k3d_vec3_cube">
<code class="descclassname">para/</code><code class="descname">k3d_vec3_cube</code> (3)<em> [</em><em>real</em><em>]</em><a class="headerlink" href="#f/para/k3d_vec3_cube" title="Permalink to this definition">¶</a></dt>
<dd><p>the 3rd k vector for the k cube</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/ntoporbitals">
<code class="descclassname">para/</code><code class="descname">ntoporbitals</code><em> [</em><em>integer</em><em>]</em><a class="headerlink" href="#f/para/ntoporbitals" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/knv2">
<code class="descclassname">para/</code><code class="descname">knv2</code><em> [</em><em>integer</em><em>]</em><a class="headerlink" href="#f/para/knv2" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of k points for each k line</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/k_mass">
<code class="descclassname">para/</code><code class="descname">k_mass</code> (3)<em> [</em><em>real</em><em>,</em><em>save/public</em><em>]</em><a class="headerlink" href="#f/para/k_mass" title="Permalink to this definition">¶</a></dt>
<dd><p>the k point for effective mass calculation</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/omegamax">
<code class="descclassname">para/</code><code class="descname">omegamax</code><em> [</em><em>real</em><em>]</em><a class="headerlink" href="#f/para/omegamax" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/k3len">
<code class="descclassname">para/</code><code class="descname">k3len</code> (*)<em> [</em><em>real</em><em>,</em><em>allocatable</em><em>]</em><a class="headerlink" href="#f/para/k3len" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/directorcart">
<code class="descclassname">para/</code><code class="descname">directorcart</code><em> [</em><em>character</em><em>]</em><a class="headerlink" href="#f/para/directorcart" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether direct coordinates or Cartisen coordinates</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/kcubevolume">
<code class="descclassname">para/</code><code class="descname">kcubevolume</code><em> [</em><em>real</em><em>]</em><a class="headerlink" href="#f/para/kcubevolume" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/zero">
<code class="descclassname">para/</code><code class="descname">zero</code><em> [</em><em>real</em><em>,</em><em>parameter=</em>0.0d0<em>]</em><a class="headerlink" href="#f/para/zero" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/ruc_new">
<code class="descclassname">para/</code><code class="descname">ruc_new</code> (3)<em> [</em><em>real</em><em>,</em><em>save/public</em><em>]</em><a class="headerlink" href="#f/para/ruc_new" title="Permalink to this definition">¶</a></dt>
<dd><p>&gt; three primitive vectors in new coordinate system, see slab part</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/slabband_calc">
<code class="descclassname">para/</code><code class="descname">slabband_calc</code><em> [</em><em>logical</em><em>]</em><a class="headerlink" href="#f/para/slabband_calc" title="Permalink to this definition">¶</a></dt>
<dd><p>Flag for 2D slab energy band calculation</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/numoccupied">
<code class="descclassname">para/</code><code class="descname">numoccupied</code><em> [</em><em>integer</em><em>]</em><a class="headerlink" href="#f/para/numoccupied" title="Permalink to this definition">¶</a></dt>
<dd><p>&gt; Number of occupied bands for bulk unit cell</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/kmesh">
<code class="descclassname">para/</code><code class="descname">kmesh</code> (2)<em> [</em><em>integer</em><em>,</em><em>parameter=</em>(/200<em>,</em><em>200/)</em><em>]</em><a class="headerlink" href="#f/para/kmesh" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/stdout_bn">
<code class="descclassname">para/</code><code class="descname">stdout_bn</code><em> [</em><em>integer</em><em>,</em><em>parameter=</em>8<em>]</em><a class="headerlink" href="#f/para/stdout_bn" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/mpi_in">
<code class="descclassname">para/</code><code class="descname">mpi_in</code><em> [</em><em>integer</em><em>,</em><em>parameter=</em>mpi_integer<em>]</em><a class="headerlink" href="#f/para/mpi_in" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/slabqpi_calc">
<code class="descclassname">para/</code><code class="descname">slabqpi_calc</code><em> [</em><em>logical</em><em>]</em><a class="headerlink" href="#f/para/slabqpi_calc" title="Permalink to this definition">¶</a></dt>
<dd><p>Flag for surface state QPI spectrum calculation</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/k3line_start">
<code class="descclassname">para/</code><code class="descname">k3line_start</code> (*,*)<em> [</em><em>real</em><em>,</em><em>allocatable</em><em>]</em><a class="headerlink" href="#f/para/k3line_start" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/orbitals_start">
<code class="descclassname">para/</code><code class="descname">orbitals_start</code> (*)<em> [</em><em>integer</em><em>,</em><em>allocatable</em><em>]</em><a class="headerlink" href="#f/para/orbitals_start" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/berrycurvature_calc">
<code class="descclassname">para/</code><code class="descname">berrycurvature_calc</code><em> [</em><em>logical</em><em>]</em><a class="headerlink" href="#f/para/berrycurvature_calc" title="Permalink to this definition">¶</a></dt>
<dd><p>Flag for Berry curvature calculation</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/bulkfs_plane_calc">
<code class="descclassname">para/</code><code class="descname">bulkfs_plane_calc</code><em> [</em><em>logical</em><em>]</em><a class="headerlink" href="#f/para/bulkfs_plane_calc" title="Permalink to this definition">¶</a></dt>
<dd><p>Flag for bulk fermi surface for a fix k plane calculation</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/k2line_name">
<code class="descclassname">para/</code><code class="descname">k2line_name</code> (32)<em> [</em><em>character</em><em>]</em><a class="headerlink" href="#f/para/k2line_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/glide_y_op">
<code class="descclassname">para/</code><code class="descname">glide_y_op</code> (*,*)<em> [</em><em>real</em><em>,</em><em>allocatable</em><em>]</em><a class="headerlink" href="#f/para/glide_y_op" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/ndegen">
<code class="descclassname">para/</code><code class="descname">ndegen</code> (*)<em> [</em><em>integer</em><em>,</em><em>allocatable</em><em>]</em><a class="headerlink" href="#f/para/ndegen" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/kuc">
<code class="descclassname">para/</code><code class="descname">kuc</code> (3)<em> [</em><em>real</em><em>,</em><em>save/public</em><em>]</em><a class="headerlink" href="#f/para/kuc" title="Permalink to this definition">¶</a></dt>
<dd><p>three reciprocal primitive vectors, c</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/kub">
<code class="descclassname">para/</code><code class="descname">kub</code> (3)<em> [</em><em>real</em><em>,</em><em>save/public</em><em>]</em><a class="headerlink" href="#f/para/kub" title="Permalink to this definition">¶</a></dt>
<dd><p>three reciprocal primitive vectors, b</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/kua">
<code class="descclassname">para/</code><code class="descname">kua</code> (3)<em> [</em><em>real</em><em>,</em><em>save/public</em><em>]</em><a class="headerlink" href="#f/para/kua" title="Permalink to this definition">¶</a></dt>
<dd><p>three reciprocal primitive vectors, a</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/k2line_stop">
<code class="descclassname">para/</code><code class="descname">k2line_stop</code> (32)<em> [</em><em>real</em><em>]</em><a class="headerlink" href="#f/para/k2line_stop" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/wannier_centers_direct">
<code class="descclassname">para/</code><code class="descname">wannier_centers_direct</code> (*,*)<em> [</em><em>real</em><em>,</em><em>allocatable</em><em>]</em><a class="headerlink" href="#f/para/wannier_centers_direct" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/mirror_z">
<code class="descclassname">para/</code><code class="descname">mirror_z</code> (*,*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em><a class="headerlink" href="#f/para/mirror_z" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/rub">
<code class="descclassname">para/</code><code class="descname">rub</code> (3)<em> [</em><em>real</em><em>,</em><em>save/public</em><em>]</em><a class="headerlink" href="#f/para/rub" title="Permalink to this definition">¶</a></dt>
<dd><p>three  primitive vectors in Cartsien coordinatec, b</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/ruc">
<code class="descclassname">para/</code><code class="descname">ruc</code> (3)<em> [</em><em>real</em><em>,</em><em>save/public</em><em>]</em><a class="headerlink" href="#f/para/ruc" title="Permalink to this definition">¶</a></dt>
<dd><p>three  primitive vectors in Cartsien coordinatec, c</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/rua">
<code class="descclassname">para/</code><code class="descname">rua</code> (3)<em> [</em><em>real</em><em>,</em><em>save/public</em><em>]</em><a class="headerlink" href="#f/para/rua" title="Permalink to this definition">¶</a></dt>
<dd><p>three  primitive vectors in Cartsien coordinatec, a</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/atom_position">
<code class="descclassname">para/</code><code class="descname">atom_position</code> (*,*)<em> [</em><em>real</em><em>,</em><em>allocatable</em><em>]</em><a class="headerlink" href="#f/para/atom_position" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/bx">
<code class="descclassname">para/</code><code class="descname">bx</code><em> [</em><em>real</em><em>]</em><a class="headerlink" href="#f/para/bx" title="Permalink to this definition">¶</a></dt>
<dd><p>&gt; magnetic field (in Tesla)</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/by">
<code class="descclassname">para/</code><code class="descname">by</code><em> [</em><em>real</em><em>]</em><a class="headerlink" href="#f/para/by" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/bz">
<code class="descclassname">para/</code><code class="descname">bz</code><em> [</em><em>real</em><em>]</em><a class="headerlink" href="#f/para/bz" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/bohr2atomic">
<code class="descclassname">para/</code><code class="descname">bohr2atomic</code><em> [</em><em>real</em><em>,</em><em>parameter=</em>0.529177211d0<em>]</em><a class="headerlink" href="#f/para/bohr2atomic" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/eta_arc">
<code class="descclassname">para/</code><code class="descname">eta_arc</code><em> [</em><em>real</em><em>]</em><a class="headerlink" href="#f/para/eta_arc" title="Permalink to this definition">¶</a></dt>
<dd><p>used to calculate dos epsilon+i eta</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/hrfile">
<code class="descclassname">para/</code><code class="descname">hrfile</code><em> [</em><em>character</em><em>]</em><a class="headerlink" href="#f/para/hrfile" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/nk3lines">
<code class="descclassname">para/</code><code class="descname">nk3lines</code><em> [</em><em>integer</em><em>]</em><a class="headerlink" href="#f/para/nk3lines" title="Permalink to this definition">¶</a></dt>
<dd><p>Howmany k lines for bulk band calculation</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/eta">
<code class="descclassname">para/</code><code class="descname">eta</code><em> [</em><em>real</em><em>]</em><a class="headerlink" href="#f/para/eta" title="Permalink to this definition">¶</a></dt>
<dd><p>used to calculate dos epsilon+i eta</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/k3line_stop">
<code class="descclassname">para/</code><code class="descname">k3line_stop</code> (*)<em> [</em><em>real</em><em>,</em><em>allocatable</em><em>]</em><a class="headerlink" href="#f/para/k3line_stop" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/ndim">
<code class="descclassname">para/</code><code class="descname">ndim</code><em> [</em><em>integer</em><em>]</em><a class="headerlink" href="#f/para/ndim" title="Permalink to this definition">¶</a></dt>
<dd><p>&gt; Leading dimension of surface green&#8217;s function</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/umatrix">
<code class="descclassname">para/</code><code class="descname">umatrix</code> (3,3)<em> [</em><em>real</em><em>,</em><em>save/public</em><em>]</em><a class="headerlink" href="#f/para/umatrix" title="Permalink to this definition">¶</a></dt>
<dd><p>a matrix change old primitive cell to new primitive cell which can define new surface, it is a 3*3 matrix</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/soc">
<code class="descclassname">para/</code><code class="descname">soc</code><em> [</em><em>integer</em><em>]</em><a class="headerlink" href="#f/para/soc" title="Permalink to this definition">¶</a></dt>
<dd><p>A parameter to control soc;  Soc=0 means no spin-orbit coupling; Soc&gt;0 means spin-orbit coupling</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/k2d_start">
<code class="descclassname">para/</code><code class="descname">k2d_start</code> (2)<em> [</em><em>real</em><em>]</em><a class="headerlink" href="#f/para/k2d_start" title="Permalink to this definition">¶</a></dt>
<dd><p>start k point for 2D system calculation, like arcs</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/k3d_start_cube">
<code class="descclassname">para/</code><code class="descname">k3d_start_cube</code> (3)<em> [</em><em>real</em><em>]</em><a class="headerlink" href="#f/para/k3d_start_cube" title="Permalink to this definition">¶</a></dt>
<dd><p>the start k point for the k cube</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/one">
<code class="descclassname">para/</code><code class="descname">one</code><em> [</em><em>real</em><em>,</em><em>parameter=</em>1.0d0<em>]</em><a class="headerlink" href="#f/para/one" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/cellvolume">
<code class="descclassname">para/</code><code class="descname">cellvolume</code><em> [</em><em>real</em><em>]</em><a class="headerlink" href="#f/para/cellvolume" title="Permalink to this definition">¶</a></dt>
<dd><p>Cell volume</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/nk1">
<code class="descclassname">para/</code><code class="descname">nk1</code><em> [</em><em>integer</em><em>]</em><a class="headerlink" href="#f/para/nk1" title="Permalink to this definition">¶</a></dt>
<dd><p>number of k points for different use</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/nk2">
<code class="descclassname">para/</code><code class="descname">nk2</code><em> [</em><em>integer</em><em>]</em><a class="headerlink" href="#f/para/nk2" title="Permalink to this definition">¶</a></dt>
<dd><p>number of k points for different use</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/nk3">
<code class="descclassname">para/</code><code class="descname">nk3</code><em> [</em><em>integer</em><em>]</em><a class="headerlink" href="#f/para/nk3" title="Permalink to this definition">¶</a></dt>
<dd><p>number of k points for different use</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/nr3">
<code class="descclassname">para/</code><code class="descname">nr3</code><em> [</em><em>integer</em><em>,</em><em>save/public</em><em>]</em><a class="headerlink" href="#f/para/nr3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/nr2">
<code class="descclassname">para/</code><code class="descname">nr2</code><em> [</em><em>integer</em><em>,</em><em>save/public</em><em>]</em><a class="headerlink" href="#f/para/nr2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/nr1">
<code class="descclassname">para/</code><code class="descname">nr1</code><em> [</em><em>integer</em><em>,</em><em>save/public</em><em>]</em><a class="headerlink" href="#f/para/nr1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/slabss_calc">
<code class="descclassname">para/</code><code class="descname">slabss_calc</code><em> [</em><em>logical</em><em>]</em><a class="headerlink" href="#f/para/slabss_calc" title="Permalink to this definition">¶</a></dt>
<dd><p>Flag for surface state ARPES spectrum calculation</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/inv_op">
<code class="descclassname">para/</code><code class="descname">inv_op</code> (*,*)<em> [</em><em>real</em><em>,</em><em>allocatable</em><em>]</em><a class="headerlink" href="#f/para/inv_op" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/ntotch">
<code class="descclassname">para/</code><code class="descname">ntotch</code><em> [</em><em>integer</em><em>]</em><a class="headerlink" href="#f/para/ntotch" title="Permalink to this definition">¶</a></dt>
<dd><p>&gt; Number of electrons</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/rb2">
<code class="descclassname">para/</code><code class="descname">rb2</code> (2)<em> [</em><em>real</em><em>,</em><em>save/public</em><em>]</em><a class="headerlink" href="#f/para/rb2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/num_wann">
<code class="descclassname">para/</code><code class="descname">num_wann</code><em> [</em><em>integer</em><em>]</em><a class="headerlink" href="#f/para/num_wann" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of Wannier functions</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/atom_name">
<code class="descclassname">para/</code><code class="descname">atom_name</code> (*)<em> [</em><em>character</em><em>,</em><em>allocatable</em><em>]</em><a class="headerlink" href="#f/para/atom_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/wireband_calc">
<code class="descclassname">para/</code><code class="descname">wireband_calc</code><em> [</em><em>logical</em><em>]</em><a class="headerlink" href="#f/para/wireband_calc" title="Permalink to this definition">¶</a></dt>
<dd><p>Flag for 1D wire energy band calculation</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/bulkgap_cube_calc">
<code class="descclassname">para/</code><code class="descname">bulkgap_cube_calc</code><em> [</em><em>logical</em><em>]</em><a class="headerlink" href="#f/para/bulkgap_cube_calc" title="Permalink to this definition">¶</a></dt>
<dd><p>Flag for Gap_cube calculation</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/pi2zi">
<code class="descclassname">para/</code><code class="descname">pi2zi</code><em> [</em><em>complex</em><em>,</em><em>parameter=</em>(0.0d0<em>,</em><em>6.283185307179586d0)</em><em>]</em><a class="headerlink" href="#f/para/pi2zi" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/k2len">
<code class="descclassname">para/</code><code class="descname">k2len</code> (*)<em> [</em><em>real</em><em>,</em><em>allocatable</em><em>]</em><a class="headerlink" href="#f/para/k2len" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/bulkband_calc">
<code class="descclassname">para/</code><code class="descname">bulkband_calc</code><em> [</em><em>logical</em><em>]</em><a class="headerlink" href="#f/para/bulkband_calc" title="Permalink to this definition">¶</a></dt>
<dd><p>Flag for bulk energy band calculation</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/toporbitals">
<code class="descclassname">para/</code><code class="descname">toporbitals</code> (*)<em> [</em><em>integer</em><em>,</em><em>allocatable</em><em>]</em><a class="headerlink" href="#f/para/toporbitals" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/k2d_vec2">
<code class="descclassname">para/</code><code class="descname">k2d_vec2</code> (2)<em> [</em><em>real</em><em>]</em><a class="headerlink" href="#f/para/k2d_vec2" title="Permalink to this definition">¶</a></dt>
<dd><p>the 2nd k vector for the k plane</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/k2d_vec1">
<code class="descclassname">para/</code><code class="descname">k2d_vec1</code> (2)<em> [</em><em>real</em><em>]</em><a class="headerlink" href="#f/para/k2d_vec1" title="Permalink to this definition">¶</a></dt>
<dd><p>the 1st k vector for the k plane</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/bulkfs_calc">
<code class="descclassname">para/</code><code class="descname">bulkfs_calc</code><em> [</em><em>logical</em><em>]</em><a class="headerlink" href="#f/para/bulkfs_calc" title="Permalink to this definition">¶</a></dt>
<dd><p>Flag for bulk 3D fermi surface in 3D BZ calculation</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/surf_onsite">
<code class="descclassname">para/</code><code class="descname">surf_onsite</code><em> [</em><em>real</em><em>]</em><a class="headerlink" href="#f/para/surf_onsite" title="Permalink to this definition">¶</a></dt>
<dd><p>&gt; surface onsite energy shift</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/zi">
<code class="descclassname">para/</code><code class="descname">zi</code><em> [</em><em>complex</em><em>,</em><em>parameter=</em>(0.0d0<em>,</em><em>1.0d0)</em><em>]</em><a class="headerlink" href="#f/para/zi" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/pi">
<code class="descclassname">para/</code><code class="descname">pi</code><em> [</em><em>real</em><em>,</em><em>parameter=</em>3.14159265359d0<em>]</em><a class="headerlink" href="#f/para/pi" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/effectivemass_calc">
<code class="descclassname">para/</code><code class="descname">effectivemass_calc</code><em> [</em><em>logical</em><em>]</em><a class="headerlink" href="#f/para/effectivemass_calc" title="Permalink to this definition">¶</a></dt>
<dd><p>Flag for effective mass calculation</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/mirror_x_op">
<code class="descclassname">para/</code><code class="descname">mirror_x_op</code> (*,*)<em> [</em><em>real</em><em>,</em><em>allocatable</em><em>]</em><a class="headerlink" href="#f/para/mirror_x_op" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/eps9">
<code class="descclassname">para/</code><code class="descname">eps9</code><em> [</em><em>real</em><em>,</em><em>parameter=</em>1e-09<em>]</em><a class="headerlink" href="#f/para/eps9" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/eps6">
<code class="descclassname">para/</code><code class="descname">eps6</code><em> [</em><em>real</em><em>,</em><em>parameter=</em>1e-06<em>]</em><a class="headerlink" href="#f/para/eps6" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/nslab">
<code class="descclassname">para/</code><code class="descname">nslab</code><em> [</em><em>integer</em><em>]</em><a class="headerlink" href="#f/para/nslab" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of slabs for 2d Slab system</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/eps3">
<code class="descclassname">para/</code><code class="descname">eps3</code><em> [</em><em>real</em><em>,</em><em>parameter=</em>0.001<em>]</em><a class="headerlink" href="#f/para/eps3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/irvec">
<code class="descclassname">para/</code><code class="descname">irvec</code> (*,*)<em> [</em><em>integer</em><em>,</em><em>allocatable</em><em>]</em><a class="headerlink" href="#f/para/irvec" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/angorbohr">
<code class="descclassname">para/</code><code class="descname">angorbohr</code><em> [</em><em>character</em><em>]</em><a class="headerlink" href="#f/para/angorbohr" title="Permalink to this definition">¶</a></dt>
<dd><p>Angstrom unit to Bohr unit</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/primitivecellvolume">
<code class="descclassname">para/</code><code class="descname">primitivecellvolume</code><em> [</em><em>real</em><em>]</em><a class="headerlink" href="#f/para/primitivecellvolume" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/e_arc">
<code class="descclassname">para/</code><code class="descname">e_arc</code><em> [</em><em>real</em><em>]</em><a class="headerlink" href="#f/para/e_arc" title="Permalink to this definition">¶</a></dt>
<dd><p>Fermi energy for arc calculation</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/mpi_dp">
<code class="descclassname">para/</code><code class="descname">mpi_dp</code><em> [</em><em>integer</em><em>,</em><em>parameter=</em>mpi_double_precision<em>]</em><a class="headerlink" href="#f/para/mpi_dp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/num_atoms">
<code class="descclassname">para/</code><code class="descname">num_atoms</code><em> [</em><em>integer</em><em>]</em><a class="headerlink" href="#f/para/num_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>number of atoms in one primitive cell</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/ka2">
<code class="descclassname">para/</code><code class="descname">ka2</code> (2)<em> [</em><em>real</em><em>,</em><em>save/public</em><em>]</em><a class="headerlink" href="#f/para/ka2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/nk3_band">
<code class="descclassname">para/</code><code class="descname">nk3_band</code><em> [</em><em>integer</em><em>]</em><a class="headerlink" href="#f/para/nk3_band" title="Permalink to this definition">¶</a></dt>
<dd><p>Howmany k points for each k line</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/cpuid">
<code class="descclassname">para/</code><code class="descname">cpuid</code><em> [</em><em>integer</em><em>]</em><a class="headerlink" href="#f/para/cpuid" title="Permalink to this definition">¶</a></dt>
<dd><p>CPU id for mpi</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/mpi_dc">
<code class="descclassname">para/</code><code class="descname">mpi_dc</code><em> [</em><em>integer</em><em>,</em><em>parameter=</em>mpi_double_complex<em>]</em><a class="headerlink" href="#f/para/mpi_dc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/nk">
<code class="descclassname">para/</code><code class="descname">nk</code><em> [</em><em>integer</em><em>]</em><a class="headerlink" href="#f/para/nk" title="Permalink to this definition">¶</a></dt>
<dd><p>number of k points for different use</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/dk_mass">
<code class="descclassname">para/</code><code class="descname">dk_mass</code><em> [</em><em>real</em><em>,</em><em>save/public</em><em>]</em><a class="headerlink" href="#f/para/dk_mass" title="Permalink to this definition">¶</a></dt>
<dd><p>k step for effective mass calculation</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/ev2hartree">
<code class="descclassname">para/</code><code class="descname">ev2hartree</code><em> [</em><em>real</em><em>,</em><em>parameter=</em>1d0/27.211385d0<em>]</em><a class="headerlink" href="#f/para/ev2hartree" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/outfileindex">
<code class="descclassname">para/</code><code class="descname">outfileindex</code><em> [</em><em>integer</em><em>,</em><em>save/public</em><em>]</em><a class="headerlink" href="#f/para/outfileindex" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/np">
<code class="descclassname">para/</code><code class="descname">np</code><em> [</em><em>integer</em><em>]</em><a class="headerlink" href="#f/para/np" title="Permalink to this definition">¶</a></dt>
<dd><p>&gt; Number of princple layers for surface green&#8217;s function</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/mirror_z_op">
<code class="descclassname">para/</code><code class="descname">mirror_z_op</code> (*,*)<em> [</em><em>real</em><em>,</em><em>allocatable</em><em>]</em><a class="headerlink" href="#f/para/mirror_z_op" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/k3d_vec2_cube">
<code class="descclassname">para/</code><code class="descname">k3d_vec2_cube</code> (3)<em> [</em><em>real</em><em>]</em><a class="headerlink" href="#f/para/k3d_vec2_cube" title="Permalink to this definition">¶</a></dt>
<dd><p>the 2nd k vector for the k cube</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/omegamin">
<code class="descclassname">para/</code><code class="descname">omegamin</code><em> [</em><em>real</em><em>]</em><a class="headerlink" href="#f/para/omegamin" title="Permalink to this definition">¶</a></dt>
<dd><p>omega interval</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/bottomorbitals">
<code class="descclassname">para/</code><code class="descname">bottomorbitals</code> (*)<em> [</em><em>integer</em><em>,</em><em>allocatable</em><em>]</em><a class="headerlink" href="#f/para/bottomorbitals" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/mpi_cmw">
<code class="descclassname">para/</code><code class="descname">mpi_cmw</code><em> [</em><em>integer</em><em>,</em><em>parameter=</em>mpi_comm_world<em>]</em><a class="headerlink" href="#f/para/mpi_cmw" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/urot">
<code class="descclassname">para/</code><code class="descname">urot</code> (3,3)<em> [</em><em>real</em><em>,</em><em>save/public</em><em>]</em><a class="headerlink" href="#f/para/urot" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotate matrix for the new primitve cell</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/k3d_start">
<code class="descclassname">para/</code><code class="descname">k3d_start</code> (3)<em> [</em><em>real</em><em>]</em><a class="headerlink" href="#f/para/k3d_start" title="Permalink to this definition">¶</a></dt>
<dd><p>the start k point for the 3D k plane</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/rua_new">
<code class="descclassname">para/</code><code class="descname">rua_new</code> (3)<em> [</em><em>real</em><em>,</em><em>save/public</em><em>]</em><a class="headerlink" href="#f/para/rua_new" title="Permalink to this definition">¶</a></dt>
<dd><p>&gt; three primitive vectors in new coordinate system, see slab part</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/nslab1">
<code class="descclassname">para/</code><code class="descname">nslab1</code><em> [</em><em>integer</em><em>]</em><a class="headerlink" href="#f/para/nslab1" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of slabs for 1D wire system</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/nslab2">
<code class="descclassname">para/</code><code class="descname">nslab2</code><em> [</em><em>integer</em><em>]</em><a class="headerlink" href="#f/para/nslab2" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of slabs for 1D wire system</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/ra2">
<code class="descclassname">para/</code><code class="descname">ra2</code> (2)<em> [</em><em>real</em><em>,</em><em>save/public</em><em>]</em><a class="headerlink" href="#f/para/ra2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/dos_calc">
<code class="descclassname">para/</code><code class="descname">dos_calc</code><em> [</em><em>logical</em><em>]</em><a class="headerlink" href="#f/para/dos_calc" title="Permalink to this definition">¶</a></dt>
<dd><p>Flag for density of state calculation</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/alpha">
<code class="descclassname">para/</code><code class="descname">alpha</code><em> [</em><em>real</em><em>,</em><em>parameter=</em>1.20736d0*1d-6<em>]</em><a class="headerlink" href="#f/para/alpha" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/max_projs">
<code class="descclassname">para/</code><code class="descname">max_projs</code><em> [</em><em>integer</em><em>]</em><a class="headerlink" href="#f/para/max_projs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/mirror_x">
<code class="descclassname">para/</code><code class="descname">mirror_x</code> (*,*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em><a class="headerlink" href="#f/para/mirror_x" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/wanniercenter_calc">
<code class="descclassname">para/</code><code class="descname">wanniercenter_calc</code><em> [</em><em>logical</em><em>]</em><a class="headerlink" href="#f/para/wanniercenter_calc" title="Permalink to this definition">¶</a></dt>
<dd><p>Flag for Wilson loop calculation</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/kb">
<code class="descclassname">para/</code><code class="descname">kb</code> (2)<em> [</em><em>real</em><em>,</em><em>parameter=</em>(/0.0d0<em>,</em><em>1.0d0/)</em><em>]</em><a class="headerlink" href="#f/para/kb" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/ka">
<code class="descclassname">para/</code><code class="descname">ka</code> (2)<em> [</em><em>real</em><em>,</em><em>parameter=</em>(/1.0d0<em>,</em><em>0.0d0/)</em><em>]</em><a class="headerlink" href="#f/para/ka" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/k3points">
<code class="descclassname">para/</code><code class="descname">k3points</code> (*,*)<em> [</em><em>real</em><em>,</em><em>allocatable</em><em>]</em><a class="headerlink" href="#f/para/k3points" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/ke">
<code class="descclassname">para/</code><code class="descname">ke</code> (2,32)<em> [</em><em>real</em><em>]</em><a class="headerlink" href="#f/para/ke" title="Permalink to this definition">¶</a></dt>
<dd><p>end k point for each k line</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/wannier_centers_cart">
<code class="descclassname">para/</code><code class="descname">wannier_centers_cart</code> (*,*)<em> [</em><em>real</em><em>,</em><em>allocatable</em><em>]</em><a class="headerlink" href="#f/para/wannier_centers_cart" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/ntopatoms">
<code class="descclassname">para/</code><code class="descname">ntopatoms</code><em> [</em><em>integer</em><em>]</em><a class="headerlink" href="#f/para/ntopatoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Select atoms on the top surface for surface state output</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/omeganum">
<code class="descclassname">para/</code><code class="descname">omeganum</code><em> [</em><em>integer</em><em>]</em><a class="headerlink" href="#f/para/omeganum" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of energy slices between OmegaMin and OmegaMax</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/k3line_name">
<code class="descclassname">para/</code><code class="descname">k3line_name</code> (*)<em> [</em><em>character</em><em>,</em><em>allocatable</em><em>]</em><a class="headerlink" href="#f/para/k3line_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/topatoms">
<code class="descclassname">para/</code><code class="descname">topatoms</code> (*)<em> [</em><em>integer</em><em>,</em><em>allocatable</em><em>]</em><a class="headerlink" href="#f/para/topatoms" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/kp">
<code class="descclassname">para/</code><code class="descname">kp</code> (2,32)<em> [</em><em>real</em><em>]</em><a class="headerlink" href="#f/para/kp" title="Permalink to this definition">¶</a></dt>
<dd><p>start k point for each k line</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/k3d_vec1_cube">
<code class="descclassname">para/</code><code class="descname">k3d_vec1_cube</code> (3)<em> [</em><em>real</em><em>]</em><a class="headerlink" href="#f/para/k3d_vec1_cube" title="Permalink to this definition">¶</a></dt>
<dd><p>the 1st k vector for the k cube</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/knv">
<code class="descclassname">para/</code><code class="descname">knv</code><em> [</em><em>integer</em><em>,</em><em>parameter=</em><a class="reference internal" href="#f/para/kmesh" title="f/para/kmesh">kmesh</a>(1)*<a class="reference internal" href="#f/para/kmesh" title="f/para/kmesh">kmesh</a>(2)<em>]</em><a class="headerlink" href="#f/para/knv" title="Permalink to this definition">¶</a></dt>
<dd><p>number of k points used for spintexture</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/para/bottomatoms">
<code class="descclassname">para/</code><code class="descname">bottomatoms</code> (*)<em> [</em><em>integer</em><em>,</em><em>allocatable</em><em>]</em><a class="headerlink" href="#f/para/bottomatoms" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="#">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Welcome to WannierTools&#8217;s documentation!</a></li>
<li><a class="reference internal" href="#installation-and-usage">Installation and Usage</a></li>
<li><a class="reference internal" href="#subroutines-and-modules">Subroutines and Modules</a><ul>
<li><a class="reference internal" href="#main-program">Main program</a></li>
<li><a class="reference internal" href="#subroutines-and-functions">Subroutines and functions</a></li>
<li><a class="reference internal" href="#aux">aux</a></li>
<li><a class="reference internal" href="#berry">berry</a></li>
<li><a class="reference internal" href="#berrycurvature">berrycurvature</a></li>
<li><a class="reference internal" href="#dos">dos</a></li>
<li><a class="reference internal" href="#effective-mass">effective_mass</a></li>
<li><a class="reference internal" href="#eigen">eigen</a></li>
<li><a class="reference internal" href="#ek-bulk">ek_bulk</a></li>
<li><a class="reference internal" href="#ek-bulk2d">ek_bulk2D</a></li>
<li><a class="reference internal" href="#ek-bulk-polar">ek_bulk_polar</a></li>
<li><a class="reference internal" href="#ek-ribbon">ek_ribbon</a></li>
<li><a class="reference internal" href="#ek-slab">ek_slab</a></li>
<li><a class="reference internal" href="#ekb-ribbon">ekb_ribbon</a></li>
<li><a class="reference internal" href="#fermiarc">fermiarc</a></li>
<li><a class="reference internal" href="#fermisurface">fermisurface</a></li>
<li><a class="reference internal" href="#ham-bulk">ham_bulk</a></li>
<li><a class="reference internal" href="#ham-qlayer2qlayer">ham_qlayer2qlayer</a></li>
<li><a class="reference internal" href="#ham-ribbon">ham_ribbon</a></li>
<li><a class="reference internal" href="#ham-ribbon-b">ham_ribbon_b</a></li>
<li><a class="reference internal" href="#ham-slab">ham_slab</a></li>
<li><a class="reference internal" href="#inverse">inverse</a></li>
<li><a class="reference internal" href="#landau-level">landau_level</a></li>
<li><a class="reference internal" href="#main">main</a></li>
<li><a class="reference internal" href="#mat-mul">mat_mul</a></li>
<li><a class="reference internal" href="#orbital-momenta">orbital_momenta</a></li>
<li><a class="reference internal" href="#psi">psi</a></li>
<li><a class="reference internal" href="#readhmnr">readHmnR</a></li>
<li><a class="reference internal" href="#readinput">readinput</a></li>
<li><a class="reference internal" href="#spintexture">spintexture</a></li>
<li><a class="reference internal" href="#surfgreen">surfgreen</a></li>
<li><a class="reference internal" href="#surfstat">surfstat</a></li>
<li><a class="reference internal" href="#symmetry">symmetry</a></li>
<li><a class="reference internal" href="#wanniercenter">wanniercenter</a></li>
<li><a class="reference internal" href="#f/para">Module para</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="#">Documentation overview</a><ul>
      <li>Next: <a href="installation.html" title="next chapter">Installation (Linux or Mac)</a></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="sources/index.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016, QuanSheng Wu.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.4.8</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.9</a>
      
      |
      <a href="sources/index.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>